<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>E Wrangling, reshaping, and tidying data with tidyr | Bio 373L Survival Guide</title>
  <meta name="description" content="Writing advice for Field Ecology." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="E Wrangling, reshaping, and tidying data with tidyr | Bio 373L Survival Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Writing advice for Field Ecology." />
  <meta name="github-repo" content="Christopher-Peterson/Bio373L-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="E Wrangling, reshaping, and tidying data with tidyr | Bio 373L Survival Guide" />
  
  <meta name="twitter:description" content="Writing advice for Field Ecology." />
  

<meta name="author" content="Christopher R. Peterson" />


<meta name="date" content="2020-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-analysis-tutorial.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bio 373L Survival Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>1</b> Writing Lab Reports: Structure</a><ul>
<li class="chapter" data-level="1.1" data-path="structure.html"><a href="structure.html#structure-overview"><i class="fa fa-check"></i><b>1.1</b> Structure Overview</a></li>
<li class="chapter" data-level="1.2" data-path="structure.html"><a href="structure.html#abstract"><i class="fa fa-check"></i><b>1.2</b> Abstract</a></li>
<li class="chapter" data-level="1.3" data-path="structure.html"><a href="structure.html#introduction"><i class="fa fa-check"></i><b>1.3</b> Introduction</a></li>
<li class="chapter" data-level="1.4" data-path="structure.html"><a href="structure.html#methods"><i class="fa fa-check"></i><b>1.4</b> Methods</a></li>
<li class="chapter" data-level="1.5" data-path="structure.html"><a href="structure.html#results"><i class="fa fa-check"></i><b>1.5</b> Results</a><ul>
<li class="chapter" data-level="1.5.1" data-path="structure.html"><a href="structure.html#reporting-statistics"><i class="fa fa-check"></i><b>1.5.1</b> Reporting statistics</a></li>
<li class="chapter" data-level="1.5.2" data-path="structure.html"><a href="structure.html#do-not-interpret-your-data-here"><i class="fa fa-check"></i><b>1.5.2</b> Do not interpret your data here</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="structure.html"><a href="structure.html#discussion"><i class="fa fa-check"></i><b>1.6</b> Discussion</a></li>
<li class="chapter" data-level="1.7" data-path="structure.html"><a href="structure.html#literature-cited"><i class="fa fa-check"></i><b>1.7</b> Literature Cited</a></li>
<li class="chapter" data-level="1.8" data-path="structure.html"><a href="structure.html#common-mistakes-for-particular-sections"><i class="fa fa-check"></i><b>1.8</b> Common Mistakes for particular sections</a><ul>
<li class="chapter" data-level="1.8.1" data-path="structure.html"><a href="structure.html#introduction-and-discussion"><i class="fa fa-check"></i><b>1.8.1</b> Introduction and Discussion</a></li>
<li class="chapter" data-level="1.8.2" data-path="structure.html"><a href="structure.html#results-1"><i class="fa fa-check"></i><b>1.8.2</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="style.html"><a href="style.html"><i class="fa fa-check"></i><b>2</b> Writing Lab Reports: Style</a><ul>
<li class="chapter" data-level="2.1" data-path="style.html"><a href="style.html#be-concise"><i class="fa fa-check"></i><b>2.1</b> Be Concise</a></li>
<li class="chapter" data-level="2.2" data-path="style.html"><a href="style.html#sentence-structure"><i class="fa fa-check"></i><b>2.2</b> Sentence Structure</a></li>
<li class="chapter" data-level="2.3" data-path="style.html"><a href="style.html#passive-voice"><i class="fa fa-check"></i><b>2.3</b> Passive Voice</a></li>
<li class="chapter" data-level="2.4" data-path="style.html"><a href="style.html#word-choice"><i class="fa fa-check"></i><b>2.4</b> Word Choice</a></li>
<li class="chapter" data-level="2.5" data-path="style.html"><a href="style.html#scientific-and-common-names"><i class="fa fa-check"></i><b>2.5</b> Scientific and Common Names</a></li>
<li class="chapter" data-level="2.6" data-path="style.html"><a href="style.html#other-grammar"><i class="fa fa-check"></i><b>2.6</b> Other Grammar</a></li>
<li class="chapter" data-level="2.7" data-path="style.html"><a href="style.html#commonly-confused-definitions"><i class="fa fa-check"></i><b>2.7</b> Commonly Confused Definitions</a></li>
<li class="chapter" data-level="2.8" data-path="style.html"><a href="style.html#significant-digits"><i class="fa fa-check"></i><b>2.8</b> Significant Digits</a></li>
<li class="chapter" data-level="2.9" data-path="style.html"><a href="style.html#tenses"><i class="fa fa-check"></i><b>2.9</b> Tenses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>3</b> Figures and Tables</a><ul>
<li class="chapter" data-level="3.1" data-path="figures.html"><a href="figures.html#captions"><i class="fa fa-check"></i><b>3.1</b> Captions</a></li>
<li class="chapter" data-level="3.2" data-path="figures.html"><a href="figures.html#figures"><i class="fa fa-check"></i><b>3.2</b> Figures</a><ul>
<li class="chapter" data-level="3.2.1" data-path="figures.html"><a href="figures.html#specific-figure-guidelines"><i class="fa fa-check"></i><b>3.2.1</b> Specific Figure Guidelines</a></li>
<li class="chapter" data-level="3.2.2" data-path="style.html"><a href="style.html#be-concise"><i class="fa fa-check"></i><b>3.2.2</b> Be Concise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="figures.html"><a href="figures.html#some-example-figures"><i class="fa fa-check"></i><b>3.3</b> Some Example Figures</a><ul>
<li class="chapter" data-level="3.3.1" data-path="figures.html"><a href="figures.html#general-formatting"><i class="fa fa-check"></i><b>3.3.1</b> General Formatting</a></li>
<li class="chapter" data-level="3.3.2" data-path="figures.html"><a href="figures.html#continuous-response-categorical-predictors"><i class="fa fa-check"></i><b>3.3.2</b> Continuous response, categorical predictors</a></li>
<li class="chapter" data-level="3.3.3" data-path="figures.html"><a href="figures.html#categorical-count-or-frequency-responses"><i class="fa fa-check"></i><b>3.3.3</b> Categorical, count, or frequency responses</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="figures.html"><a href="figures.html#tables"><i class="fa fa-check"></i><b>3.4</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>4</b> Lab 1: Succession</a><ul>
<li class="chapter" data-level="4.1" data-path="lab1.html"><a href="lab1.html#introduction-to-the-lab"><i class="fa fa-check"></i><b>4.1</b> Introduction to the lab</a></li>
<li class="chapter" data-level="4.2" data-path="lab1.html"><a href="lab1.html#materials-and-methods"><i class="fa fa-check"></i><b>4.2</b> Materials and Methods</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lab1.html"><a href="lab1.html#bfl-habitat-regions"><i class="fa fa-check"></i><b>4.2.1</b> BFL habitat regions</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab1.html"><a href="lab1.html#data-collection"><i class="fa fa-check"></i><b>4.2.2</b> Data Collection</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab1.html"><a href="lab1.html#analysis-to-perform"><i class="fa fa-check"></i><b>4.3</b> Analysis to perform</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lab1.html"><a href="lab1.html#canopy-tree-density"><i class="fa fa-check"></i><b>4.3.1</b> Canopy tree density</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab1.html"><a href="lab1.html#species-by-habitat-and-life-stage"><i class="fa fa-check"></i><b>4.3.2</b> Species by habitat and life stage</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="structure.html"><a href="structure.html#discussion"><i class="fa fa-check"></i><b>4.4</b> Discussion</a></li>
<li class="chapter" data-level="4.5" data-path="lab1.html"><a href="lab1.html#general-comments-post-review"><i class="fa fa-check"></i><b>4.5</b> General Comments (Post-Review)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="figures.html"><a href="figures.html#figures"><i class="fa fa-check"></i><b>4.5.1</b> Figures</a></li>
<li class="chapter" data-level="4.5.2" data-path="lab1.html"><a href="lab1.html#write-this-like-youre-trying-to-publish-it"><i class="fa fa-check"></i><b>4.5.2</b> Write this like you're trying to publish it</a></li>
<li class="chapter" data-level="4.5.3" data-path="lab1.html"><a href="lab1.html#describe-the-habitats"><i class="fa fa-check"></i><b>4.5.3</b> Describe the habitats</a></li>
<li class="chapter" data-level="4.5.4" data-path="lab1.html"><a href="lab1.html#the-analysis"><i class="fa fa-check"></i><b>4.5.4</b> The Analysis</a></li>
<li class="chapter" data-level="4.5.5" data-path="lab1.html"><a href="lab1.html#keeping-things-in-the-right-sections"><i class="fa fa-check"></i><b>4.5.5</b> Keeping things in the right sections</a></li>
<li class="chapter" data-level="4.5.6" data-path="lab1.html"><a href="lab1.html#basic-style-and-format-rules"><i class="fa fa-check"></i><b>4.5.6</b> Basic style and format rules</a></li>
<li class="chapter" data-level="4.5.7" data-path="lab1.html"><a href="lab1.html#other-comments"><i class="fa fa-check"></i><b>4.5.7</b> Other Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Lab2.html"><a href="Lab2.html"><i class="fa fa-check"></i><b>5</b> Lab 2: Woodland Heterogeneity</a><ul>
<li class="chapter" data-level="5.1" data-path="Lab2.html"><a href="Lab2.html#introduction-background"><i class="fa fa-check"></i><b>5.1</b> Introduction &amp; background</a></li>
<li class="chapter" data-level="5.2" data-path="Lab2.html"><a href="Lab2.html#questions-and-hypotheses"><i class="fa fa-check"></i><b>5.2</b> Questions and Hypotheses</a></li>
<li class="chapter" data-level="5.3" data-path="Lab2.html"><a href="Lab2.html#field-methods"><i class="fa fa-check"></i><b>5.3</b> Field Methods</a></li>
<li class="chapter" data-level="5.4" data-path="Lab2.html"><a href="Lab2.html#analyses"><i class="fa fa-check"></i><b>5.4</b> Analyses</a><ul>
<li class="chapter" data-level="5.4.1" data-path="Lab2.html"><a href="Lab2.html#calibrating-canopy-estimates"><i class="fa fa-check"></i><b>5.4.1</b> Calibrating canopy estimates</a></li>
<li class="chapter" data-level="5.4.2" data-path="Lab2.html"><a href="Lab2.html#relationship-between-canopy-and-ground-cover"><i class="fa fa-check"></i><b>5.4.2</b> Relationship between canopy and ground cover</a></li>
<li class="chapter" data-level="5.4.3" data-path="Lab2.html"><a href="Lab2.html#quantifying-the-spatial-mosaic"><i class="fa fa-check"></i><b>5.4.3</b> Quantifying the spatial mosaic</a></li>
<li class="chapter" data-level="5.4.4" data-path="Lab2.html"><a href="Lab2.html#historical-trends"><i class="fa fa-check"></i><b>5.4.4</b> Historical Trends</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="working-with-r.html"><a href="working-with-r.html"><i class="fa fa-check"></i><b>A</b> Working with R</a><ul>
<li class="chapter" data-level="A.1" data-path="working-with-r.html"><a href="working-with-r.html#introduction-to-rstudio"><i class="fa fa-check"></i><b>A.1</b> Introduction to RStudio</a><ul>
<li class="chapter" data-level="A.1.1" data-path="working-with-r.html"><a href="working-with-r.html#rstudio-projects"><i class="fa fa-check"></i><b>A.1.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="A.1.2" data-path="working-with-r.html"><a href="working-with-r.html#customizing-rstudio"><i class="fa fa-check"></i><b>A.1.2</b> Customizing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="working-with-r.html"><a href="working-with-r.html#r-basics"><i class="fa fa-check"></i><b>A.2</b> R basics</a><ul>
<li class="chapter" data-level="A.2.1" data-path="working-with-r.html"><a href="working-with-r.html#statements-vectors"><i class="fa fa-check"></i><b>A.2.1</b> Statements &amp; vectors</a></li>
<li class="chapter" data-level="A.2.2" data-path="working-with-r.html"><a href="working-with-r.html#variables"><i class="fa fa-check"></i><b>A.2.2</b> Variables</a></li>
<li class="chapter" data-level="A.2.3" data-path="working-with-r.html"><a href="working-with-r.html#reading-working-with-data-frames"><i class="fa fa-check"></i><b>A.2.3</b> Reading &amp; working with data frames</a></li>
<li class="chapter" data-level="A.2.4" data-path="working-with-r.html"><a href="working-with-r.html#functions"><i class="fa fa-check"></i><b>A.2.4</b> Functions</a></li>
<li class="chapter" data-level="A.2.5" data-path="working-with-r.html"><a href="working-with-r.html#getting-help"><i class="fa fa-check"></i><b>A.2.5</b> Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html"><i class="fa fa-check"></i><b>B</b> Making graphs in R with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="B.1" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#components-of-a-plot"><i class="fa fa-check"></i><b>B.1</b> Components of a plot</a></li>
<li class="chapter" data-level="B.2" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#aesthetics-and-scales"><i class="fa fa-check"></i><b>B.2</b> Aesthetics and scales</a><ul>
<li class="chapter" data-level="B.2.1" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#color"><i class="fa fa-check"></i><b>B.2.1</b> Color</a></li>
<li class="chapter" data-level="B.2.2" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#shape"><i class="fa fa-check"></i><b>B.2.2</b> Shape</a></li>
<li class="chapter" data-level="B.2.3" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#size"><i class="fa fa-check"></i><b>B.2.3</b> Size</a></li>
<li class="chapter" data-level="B.2.4" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#fixed-aesthetics"><i class="fa fa-check"></i><b>B.2.4</b> Fixed aesthetics</a></li>
<li class="chapter" data-level="B.2.5" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#combining-aesthetics"><i class="fa fa-check"></i><b>B.2.5</b> Combining aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#geometry"><i class="fa fa-check"></i><b>B.3</b> Geometry</a><ul>
<li class="chapter" data-level="B.3.1" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#continuous-x-no-y"><i class="fa fa-check"></i><b>B.3.1</b> Continuous X, no Y</a></li>
<li class="chapter" data-level="B.3.2" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#ggp_discx_conty"><i class="fa fa-check"></i><b>B.3.2</b> Discrete X, continuous Y</a></li>
<li class="chapter" data-level="B.3.3" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#continuous-x-and-y"><i class="fa fa-check"></i><b>B.3.3</b> Continuous X and Y</a></li>
<li class="chapter" data-level="B.3.4" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#time-series-data"><i class="fa fa-check"></i><b>B.3.4</b> Time series data</a></li>
<li class="chapter" data-level="B.3.5" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#discrete-x-and-y"><i class="fa fa-check"></i><b>B.3.5</b> Discrete X and Y</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#facets"><i class="fa fa-check"></i><b>B.4</b> Facets</a></li>
<li class="chapter" data-level="B.5" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#changing-the-theme-axis-titles-other-visual-elements"><i class="fa fa-check"></i><b>B.5</b> Changing the theme, axis titles, &amp; other visual elements</a></li>
<li class="chapter" data-level="B.6" data-path="ggplot-tutorial.html"><a href="ggplot-tutorial.html#more-references"><i class="fa fa-check"></i><b>B.6</b> More references</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html"><i class="fa fa-check"></i><b>C</b> Data manipulation with <code>dplyr</code></a><ul>
<li class="chapter" data-level="C.1" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#the-pipe"><i class="fa fa-check"></i><b>C.1</b> The Pipe (%&gt;%)</a></li>
<li class="chapter" data-level="C.2" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#addingmodifying-columns-mutate"><i class="fa fa-check"></i><b>C.2</b> Adding/modifying columns (mutate)</a></li>
<li class="chapter" data-level="C.3" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#subsetting-by-row-filter"><i class="fa fa-check"></i><b>C.3</b> Subsetting by row (filter)</a></li>
<li class="chapter" data-level="C.4" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#subsetting-by-column-select"><i class="fa fa-check"></i><b>C.4</b> Subsetting by column (select)</a></li>
<li class="chapter" data-level="C.5" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#sorting-by-columns-arrange"><i class="fa fa-check"></i><b>C.5</b> Sorting by columns (arrange)</a></li>
<li class="chapter" data-level="C.6" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#summarizing-data"><i class="fa fa-check"></i><b>C.6</b> Summarizing data</a></li>
<li class="chapter" data-level="C.7" data-path="dplyr-tutorial.html"><a href="dplyr-tutorial.html#group-operations"><i class="fa fa-check"></i><b>C.7</b> Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html"><i class="fa fa-check"></i><b>D</b> Performing some useful analyses in R</a><ul>
<li class="chapter" data-level="D.1" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#a-note-on-factors"><i class="fa fa-check"></i><b>D.1</b> A note on factors</a></li>
<li class="chapter" data-level="D.2" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#comparing-categorical-frequencies-contingency-tables-related-analyses"><i class="fa fa-check"></i><b>D.2</b> Comparing categorical frequencies (Contingency Tables &amp; related analyses)</a><ul>
<li class="chapter" data-level="D.2.1" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#contingency-tables"><i class="fa fa-check"></i><b>D.2.1</b> Contingency Tables</a></li>
<li class="chapter" data-level="D.2.2" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#chi-squared-fishers-exact-tests"><i class="fa fa-check"></i><b>D.2.2</b> Chi-squared &amp; Fisher's Exact Tests</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#linear-models-regression-and-anova"><i class="fa fa-check"></i><b>D.3</b> Linear Models: Regression and ANOVA</a><ul>
<li class="chapter" data-level="D.3.1" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#regression"><i class="fa fa-check"></i><b>D.3.1</b> Regression</a></li>
<li class="chapter" data-level="D.3.2" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#anova"><i class="fa fa-check"></i><b>D.3.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#to-do-in-progress"><i class="fa fa-check"></i><b>D.4</b> To do (In progress)</a><ul>
<li class="chapter" data-level="D.4.1" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#comparing-two-means-t-tests"><i class="fa fa-check"></i><b>D.4.1</b> Comparing two means (t-tests)</a></li>
<li class="chapter" data-level="D.4.2" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#advanced-workflow-tips"><i class="fa fa-check"></i><b>D.4.2</b> Advanced workflow tips</a></li>
<li class="chapter" data-level="D.4.3" data-path="r-analysis-tutorial.html"><a href="r-analysis-tutorial.html#model-comparisons"><i class="fa fa-check"></i><b>D.4.3</b> Model comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html"><i class="fa fa-check"></i><b>E</b> Wrangling, reshaping, and tidying data with <code>tidyr</code></a><ul>
<li class="chapter" data-level="E.1" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#tidy-data"><i class="fa fa-check"></i><b>E.1</b> Tidy data</a></li>
<li class="chapter" data-level="E.2" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#pivot-longer-tutorial"><i class="fa fa-check"></i><b>E.2</b> Going from many columns to many rows: <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="E.3" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#separate-tutorial"><i class="fa fa-check"></i><b>E.3</b> Splitting and merging columns: <code>separate() and unite()</code></a></li>
<li class="chapter" data-level="E.4" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#pivot-longer-multi-tutorial"><i class="fa fa-check"></i><b>E.4</b> Pivoting multiple columns</a><ul>
<li class="chapter" data-level="E.4.1" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#combining-pivot_longer-with-summarise"><i class="fa fa-check"></i><b>E.4.1</b> Combining <code>pivot_longer()</code> with <code>summarise()</code></a></li>
</ul></li>
<li class="chapter" data-level="E.5" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#pivot-wider-tutorial"><i class="fa fa-check"></i><b>E.5</b> Going from many rows to many columns: <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="E.6" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#combining-data-frames-in-progress"><i class="fa fa-check"></i><b>E.6</b> Combining data frames (In Progress)</a><ul>
<li class="chapter" data-level="E.6.1" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#binding-rows"><i class="fa fa-check"></i><b>E.6.1</b> Binding rows</a></li>
<li class="chapter" data-level="E.6.2" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#binding-columns-by-position"><i class="fa fa-check"></i><b>E.6.2</b> Binding columns by position</a></li>
<li class="chapter" data-level="E.6.3" data-path="tidyr-tutorial.html"><a href="tidyr-tutorial.html#joining-rows-by-value"><i class="fa fa-check"></i><b>E.6.3</b> Joining rows by value</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bio 373L Survival Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyr-tutorial" class="section level1">
<h1><span class="header-section-number">E</span> Wrangling, reshaping, and tidying data with <code>tidyr</code></h1>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">E.1</span> Tidy data</h2>
<p>Most of the previous appendices have required you to have your data in a <strong>tidy</strong> format. Tidy data consist of data frames with the following characteristics:</p>
<ol style="list-style-type: decimal">
<li>Each column is a different variable</li>
<li>Each row is a single observation</li>
<li>Each cell is a single value</li>
</ol>
<p>The packages in the <code>tidyverse</code> are generally designed to operate on tidy data; however, other functions may require the data to be in a different shape. It's also frequently convenient to record field data in a non-tidy format. The <code>tidyr</code> package is designed to reshape your data. For more information on tidy data, please see <a href="https://tidyr.tidyverse.org/articles/tidy-data.html">this article</a>.</p>
<p>We're going to be using some new datasets for this chapter; if you don't have them already, <a href="https://github.com/Christopher-Peterson/Bio373L-Book/tree/master/example_data">download them here</a> and put them in your &quot;example_data&quot; directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse) 
<span class="kw">library</span>(cowplot)
<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>())
lizards &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;example_data/anoles.csv&quot;</span>) <span class="co"># See Appendix A if you don&#39;t have this data</span>
succession_data_wide &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;example_data/succession_wide.csv&quot;</span>)
yeast_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;example_data/yeast_data_partial.csv&quot;</span>)</code></pre></div>
</div>
<div id="pivot-longer-tutorial" class="section level2">
<h2><span class="header-section-number">E.2</span> Going from many columns to many rows: <code>pivot_longer()</code></h2>
<p>Let's look at the succession data file; this is slightly modified data from Fall 2018, which was collected as part of the first lab (Section @ref(#lab1)).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(succession_data_wide)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:right;">
Sample
</th>
<th style="text-align:left;">
Quadrant
</th>
<th style="text-align:right;">
Distance
</th>
<th style="text-align:right;">
DBH
</th>
<th style="text-align:right;">
Acer negundo (Boxwood elder)
</th>
<th style="text-align:right;">
Bumelia lanuginosa (Gum elastic)
</th>
<th style="text-align:right;">
Carya illinoiensis (Pecan)
</th>
<th style="text-align:right;">
Celtis spp. (Hackberry)
</th>
<th style="text-align:right;">
Fraxinus texana (Texas ash)
</th>
<th style="text-align:right;">
Juniperus spp. (Juniper)
</th>
<th style="text-align:right;">
Melia azederach (Chinaberry)
</th>
<th style="text-align:right;">
Morus rubra (Red mulberry)
</th>
<th style="text-align:right;">
Populus deltoides (Cottonwood)
</th>
<th style="text-align:right;">
Prunus caroliniana (Laurel cherry)
</th>
<th style="text-align:right;">
Quercus buckleyi (Spanish oak)
</th>
<th style="text-align:right;">
Quercus fusiformis (Live oak)
</th>
<th style="text-align:right;">
Quercus stellata (Post Oak)
</th>
<th style="text-align:right;">
Triadica sebifera (Chinese Tallow)
</th>
<th style="text-align:right;">
Ulmus americana (American elm)
</th>
<th style="text-align:right;">
Ulmus crassifolia (Cedar elm)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<p>A quick description of the columns:</p>
<ul>
<li><strong>Type</strong>: Contains information on both the habitat type and Canopy/Understory</li>
<li><strong>Team</strong>, <strong>Sample</strong>, <strong>Quadrant</strong>: identifiers for where the data were collected</li>
<li><strong>Distance</strong>: Distance in meters fromt the central point to the tree</li>
<li><strong>DBH</strong>: Diameter at breast height for canopy trees</li>
<li><strong>16 species columns</strong>: These indicate whether the named species is present with a 1; there should only be a single 1 per row.</li>
</ul>
<p>This clearly does not meet the definition of tidy data; the &quot;Species&quot; variable is split between columns, and the habitat type and tree type are both combined into a single &quot;type&quot; column.</p>
<p>The first step to tidying this data is consolidate the last sixteen columns; we're going to use <code>pivot_longer()</code> for that. In its simplest form, <code>pivot_longer()</code> converts several columns into two: one with the original column names, and the other with the original column values. This will result in a data frame with more rows than the original (hence, &quot;longer&quot;).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pivot_longer</span>(
    <span class="co"># The first argument is the column names you want to reshape</span>
    <span class="co"># This uses the same syntax of select() and across() from dplyr</span>
    <span class="dt">cols =</span> <span class="op">-</span><span class="kw">c</span>(Type<span class="op">:</span>DBH), <span class="co"># minus sign grabs everything NOT between Type &amp; DBH: </span>
    <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="co"># Name of the column that stores the old column names</span>
    <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Name of the oclumn that stores old cell values</span>
<span class="st">  </span><span class="kw">View</span>()</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:right;">
Sample
</th>
<th style="text-align:left;">
Quadrant
</th>
<th style="text-align:right;">
Distance
</th>
<th style="text-align:right;">
DBH
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:right;">
is_present
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Acer negundo (Boxwood elder)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Bumelia lanuginosa (Gum elastic)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Carya illinoiensis (Pecan)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Fraxinus texana (Texas ash)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Melia azederach (Chinaberry)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Morus rubra (Red mulberry)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Populus deltoides (Cottonwood)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
Prunus caroliniana (Laurel cherry)
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<p>If you'll notice, the first 16 rows are identical in the <code>Type:DBH</code> columns, while <code>Species</code> and <code>is_present</code> vary. A few alternative ways to do the same thing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The only difference between these is the .cols argument</span>
succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(
    <span class="dt">.cols =</span> <span class="dv">7</span><span class="op">:</span><span class="dv">22</span>, <span class="co"># positions of the columns to pivot</span>
    <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>)
succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(
    <span class="op">-</span><span class="kw">c</span>(Type, Team, Sample, Quadrant, Distance, DBH), <span class="co"># explicitly list names</span>
    <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>)
succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(
  <span class="co"># You can use ranges of column names to keep, though that&#39;s not practical here</span>
    <span class="st">`</span><span class="dt">Acer negundo (Boxwood elder)</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Ulmus crassifolia (Cedar elm)</span><span class="st">`</span>,
    <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>)
succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(
  <span class="dt">.cols =</span> <span class="kw">contains</span>(<span class="st">&quot;(&quot;</span>), <span class="co"># graps all columns with an open parentheses in them</span>
  <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>)</code></pre></div>
<p>Note that the <code>.cols</code> argument generally doesn't have quotations around its column names, while the <code>names_to</code> and <code>values_to</code> do. The simplest explanation for it is that the <code>.cols</code> columns already exist in the data, so R knows how to find them; the others don't, so we use quotes to create the names (This isn't entirely true, but the full details are quite complicated and it's a useful rule of thumb for <code>tidyverse</code> functions).</p>
<p>One thing to note about our output is that there's a lot of <code>NA</code> values in <code>is_present</code>, indicating species that were not found at each point. We don't really care about those, so let's get rid of them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">succession_longer =<span class="st"> </span>
<span class="st">  </span>succession_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(
    <span class="dt">cols =</span> <span class="op">-</span><span class="kw">c</span>(Type<span class="op">:</span>DBH), <span class="dt">names_to =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;is_present&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(is_present)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Remove missing values</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>is_present) <span class="co"># This column is no longer useful</span>
<span class="kw">View</span>(succession_longer)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:right;">
Sample
</th>
<th style="text-align:left;">
Quadrant
</th>
<th style="text-align:right;">
Distance
</th>
<th style="text-align:right;">
DBH
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
</tbody>
</table>
</div>
<p>(( Add example to practice with genotype data))</p>
</div>
<div id="separate-tutorial" class="section level2">
<h2><span class="header-section-number">E.3</span> Splitting and merging columns: <code>separate() and unite()</code></h2>
<p>To fully tidy this, we need to split the &quot;Type&quot; column into habitat type and tree type columns. The <code>separate()</code> function is useful for this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">succession_sep =<span class="st"> </span>succession_longer <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> Type, <span class="co"># Column to separate; note that the arg is col, not .col</span>
           <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Habitat&quot;</span>, <span class="st">&quot;Tree_type&quot;</span>), <span class="co"># Names of the new columns to separate into</span>
           <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>) <span class="co"># the character used to mark the separation</span>
<span class="kw">View</span>(succession_sep)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Habitat
</th>
<th style="text-align:left;">
Tree_type
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:right;">
Sample
</th>
<th style="text-align:left;">
Quadrant
</th>
<th style="text-align:right;">
Distance
</th>
<th style="text-align:right;">
DBH
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the <code>sep</code> argument can be either text or a integer(s); if it's a character vector, the character(s) are removed during the split (as with above). If <code>sep</code> is an integer (or integer vector), then the split is made after that/those position(s) in the text without removing anything.</p>
<p>It would also be useful to have a column that specifically identifies the each sample point; currenlty, that information is split between the <code>Habitat</code>, <code>Team</code>, and <code>Sample</code> columns. The <code>unite()</code> function does this (it's the complement of <code>separate</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">succession_tidy =<span class="st"> </span>succession_sep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unite</span>(<span class="dt">col =</span> <span class="st">&quot;sample_point&quot;</span>, <span class="co"># Name of new colum</span>
        Habitat, Team, Sample, <span class="co"># columns to unite (note; these are all seaprate args)</span>
        <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>, <span class="co"># separate the columns with a dash</span>
        <span class="dt">remove =</span> <span class="ot">FALSE</span> <span class="co"># by default, unite() removes the columns to separate; this disables that because we want to keep Habitat</span>
        ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Team, <span class="op">-</span>Sample) 
succession_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
sample_point
</th>
<th style="text-align:left;">
Habitat
</th>
<th style="text-align:left;">
Tree_type
</th>
<th style="text-align:left;">
Quadrant
</th>
<th style="text-align:right;">
Distance
</th>
<th style="text-align:right;">
DBH
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Quercus fusiformis (Live oak)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Juniperus spp. (Juniper)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-1
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
d
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Celtis spp. (Hackberry)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-2
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
<tr>
<td style="text-align:left;">
P-A-2
</td>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
Ulmus crassifolia (Cedar elm)
</td>
</tr>
</tbody>
</table>
</div>
<p>An alternative option to <code>unite()</code> is to use a combination of <code>mutate()</code> and <code>paste()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">succession_sep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_point =</span> <span class="kw">paste</span>(Habitat, Team, Sample, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Team, <span class="op">-</span>Sample) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">View</span>() <span class="co"># The column order will be different, but otherwise it&#39;s the same.</span></code></pre></div>
</div>
<div id="pivot-longer-multi-tutorial" class="section level2">
<h2><span class="header-section-number">E.4</span> Pivoting multiple columns</h2>
<p>We're going to take a look a dataset from <a href="https://www.molbiolcell.org/doi/full/10.1091/mbc.e07-08-0779">Brauer et al (2008)</a>. The experiment tested yeast gene expression under nutrient limitation (for several different nutrients &amp; several different concentrations).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(yeast_data)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
gene_name
</th>
<th style="text-align:left;">
bio_process
</th>
<th style="text-align:left;">
mol_func
</th>
<th style="text-align:left;">
syst_id
</th>
<th style="text-align:right;">
G0.05
</th>
<th style="text-align:right;">
G0.1
</th>
<th style="text-align:right;">
G0.15
</th>
<th style="text-align:right;">
G0.2
</th>
<th style="text-align:right;">
G0.25
</th>
<th style="text-align:right;">
G0.3
</th>
<th style="text-align:right;">
N0.05
</th>
<th style="text-align:right;">
N0.1
</th>
<th style="text-align:right;">
N0.15
</th>
<th style="text-align:right;">
N0.2
</th>
<th style="text-align:right;">
N0.25
</th>
<th style="text-align:right;">
N0.3
</th>
<th style="text-align:right;">
P0.05
</th>
<th style="text-align:right;">
P0.1
</th>
<th style="text-align:right;">
P0.15
</th>
<th style="text-align:right;">
P0.2
</th>
<th style="text-align:right;">
P0.25
</th>
<th style="text-align:right;">
P0.3
</th>
<th style="text-align:right;">
S0.05
</th>
<th style="text-align:right;">
S0.1
</th>
<th style="text-align:right;">
S0.15
</th>
<th style="text-align:right;">
S0.2
</th>
<th style="text-align:right;">
S0.25
</th>
<th style="text-align:right;">
S0.3
</th>
<th style="text-align:right;">
L0.05
</th>
<th style="text-align:right;">
L0.1
</th>
<th style="text-align:right;">
L0.15
</th>
<th style="text-align:right;">
L0.2
</th>
<th style="text-align:right;">
L0.25
</th>
<th style="text-align:right;">
L0.3
</th>
<th style="text-align:right;">
U0.05
</th>
<th style="text-align:right;">
U0.1
</th>
<th style="text-align:right;">
U0.15
</th>
<th style="text-align:right;">
U0.2
</th>
<th style="text-align:right;">
U0.25
</th>
<th style="text-align:right;">
U0.3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SFB2
</td>
<td style="text-align:left;">
ER to Golgi transport
</td>
<td style="text-align:left;">
molecular function unknown
</td>
<td style="text-align:left;">
YNL049C
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
-0.51
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.28
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
biological process unknown
</td>
<td style="text-align:left;">
molecular function unknown
</td>
<td style="text-align:left;">
YNL095C
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.40
</td>
<td style="text-align:right;">
-0.48
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
-0.44
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-1.02
</td>
<td style="text-align:right;">
-0.91
</td>
<td style="text-align:right;">
-0.59
</td>
<td style="text-align:right;">
-0.61
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
QRI7
</td>
<td style="text-align:left;">
proteolysis and peptidolysis
</td>
<td style="text-align:left;">
metalloendopeptidase activity
</td>
<td style="text-align:left;">
YDL104C
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.66
</td>
<td style="text-align:right;">
-0.40
</td>
<td style="text-align:right;">
-0.46
</td>
<td style="text-align:right;">
-0.43
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.47
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
-0.33
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.91
</td>
<td style="text-align:right;">
-0.94
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
-0.36
</td>
<td style="text-align:right;">
-0.49
</td>
<td style="text-align:right;">
-0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
CFT2
</td>
<td style="text-align:left;">
mRNA polyadenylylation*
</td>
<td style="text-align:left;">
RNA binding
</td>
<td style="text-align:left;">
YLR115W
</td>
<td style="text-align:right;">
-0.33
</td>
<td style="text-align:right;">
-0.41
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.49
</td>
<td style="text-align:right;">
-0.49
</td>
<td style="text-align:right;">
-0.43
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
-0.43
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.33
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
-0.28
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.53
</td>
<td style="text-align:right;">
-0.51
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
SSO2
</td>
<td style="text-align:left;">
vesicle fusion*
</td>
<td style="text-align:left;">
t-SNARE activity
</td>
<td style="text-align:left;">
YMR183C
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.58
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
-0.29
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.59
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.45
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
PSP2
</td>
<td style="text-align:left;">
biological process unknown
</td>
<td style="text-align:left;">
molecular function unknown
</td>
<td style="text-align:left;">
YML017W
</td>
<td style="text-align:right;">
-0.69
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.40
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
-1.19
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.62
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.37
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.65
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
RIB2
</td>
<td style="text-align:left;">
riboflavin biosynthesis
</td>
<td style="text-align:left;">
pseudouridylate synthase activity*
</td>
<td style="text-align:left;">
YOL066C
</td>
<td style="text-align:right;">
-0.55
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
-0.51
</td>
<td style="text-align:right;">
-0.37
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.39
</td>
<td style="text-align:right;">
-0.60
</td>
<td style="text-align:right;">
-0.29
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
VMA13
</td>
<td style="text-align:left;">
vacuolar acidification
</td>
<td style="text-align:left;">
hydrogen-transporting ATPase activity, rotational mechanism
</td>
<td style="text-align:left;">
YPR036W
</td>
<td style="text-align:right;">
-0.75
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.41
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.47
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.49
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.40
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
EDC3
</td>
<td style="text-align:left;">
deadenylylation-independent decapping
</td>
<td style="text-align:left;">
molecular function unknown
</td>
<td style="text-align:left;">
YEL015W
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
-0.38
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
VPS5
</td>
<td style="text-align:left;">
protein retention in Golgi*
</td>
<td style="text-align:left;">
protein transporter activity
</td>
<td style="text-align:left;">
YOR069W
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.38
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
-0.38
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.12
</td>
</tr>
</tbody>
</table>
</div>
<p>The first four columns are single variables (gene name, biological process, molecular function, and systematic_id). The remaining columns (<code>G0.05</code> through <code>U0.3</code>) contain TWO variables in their name: the nutrient that was added to the substrate (first letter) and rate at which it was added (the rest). The values in these columns is the gene expression level. To tidy the data, we need to convert these into three columns:</p>
<ul>
<li>Substrate</li>
<li>Concentration</li>
<li>Gene expression</li>
</ul>
<p>While we could do this with a combination of <code>pivot_longer()</code> and <code>separate()</code>, <code>pivot_longer()</code> can do both tasks at once with a few extra arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yeast_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pivot_longer</span>(G0.<span class="dv">05</span><span class="op">:</span>U0.<span class="dv">3</span>,
    <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Substrate&quot;</span>, <span class="st">&quot;Concentration&quot;</span>), <span class="co"># The names will go into these columns</span>
    <span class="dt">names_sep =</span> <span class="dv">1</span>, <span class="co"># separate the names between columns after the first character</span>
    <span class="dt">values_to =</span> <span class="st">&quot;Gene_expression&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">glimpse</span>()
## Rows: 199,332
## Columns: 7
## $ gene_name       &lt;chr&gt; &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2
## $ bio_process     &lt;chr&gt; &quot;ER to Golgi transport&quot;, &quot;ER to Golgi transport&quot;, &quot;ER
## $ mol_func        &lt;chr&gt; &quot;molecular function unknown&quot;, &quot;molecular function unk
## $ syst_id         &lt;chr&gt; &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;
## $ Substrate       &lt;chr&gt; &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;
## $ Concentration   &lt;chr&gt; &quot;0.05&quot;, &quot;0.1&quot;, &quot;0.15&quot;, &quot;0.2&quot;, &quot;0.25&quot;, &quot;0.3&quot;, &quot;0.05&quot;, 
## $ Gene_expression &lt;dbl&gt; -0.24, -0.13, -0.21, -0.15, -0.05, -0.05, 0.20, 0.24,</code></pre></div>
<p>The <code>names_sep</code> argument works exactly like <code>sep</code> in <code>separate()</code>.</p>
<p>Notice that <code>Concentration</code> is listed as a character vector (<code>&lt;chr&gt;</code>). It's probably a good idea to have it as a numeric vector instead. The <code>names_transform</code> argument lets you specify a function that can be applied to the names column(s) after they're re-shaped. In this case, we're going to use <code>as.numeric()</code> to convert it into a number.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># We&#39;re going to create a list that tells pivot_longer to use the </span>
  <span class="co"># as.numeric() function on Concentration</span>
  <span class="co"># a list() is basically a big box you can put any other kind of data structure into</span>
  <span class="co"># Each item in a list is called an elements; elements can be named or not</span>
  <span class="co"># This list has one named element; if we wanted to transform more columns, we could include them here as well</span>
convert_concentration =<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">Concentration =</span> as.numeric <span class="co"># Note there&#39;s no parentheses; this is because we&#39;re identifying the function, not calling it.</span>
  ) 

<span class="co"># We&#39;ll talk more about lists later</span>

tidy_yeast =<span class="st"> </span>yeast_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pivot_longer</span>(G0.<span class="dv">05</span><span class="op">:</span>U0.<span class="dv">3</span>,
    <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Substrate&quot;</span>, <span class="st">&quot;Concentration&quot;</span>), <span class="dt">names_sep =</span> <span class="dv">1</span>, 
    <span class="dt">names_transform =</span> convert_concentration, <span class="co"># We could also have defined the list here</span>
    <span class="dt">values_to =</span> <span class="st">&quot;Gene_expression&quot;</span>) 
tidy_yeast <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()
## Rows: 199,332
## Columns: 7
## $ gene_name       &lt;chr&gt; &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2&quot;, &quot;SFB2
## $ bio_process     &lt;chr&gt; &quot;ER to Golgi transport&quot;, &quot;ER to Golgi transport&quot;, &quot;ER
## $ mol_func        &lt;chr&gt; &quot;molecular function unknown&quot;, &quot;molecular function unk
## $ syst_id         &lt;chr&gt; &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;, &quot;YNL049C&quot;
## $ Substrate       &lt;chr&gt; &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;G&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;
## $ Concentration   &lt;dbl&gt; 0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.05, 0.10, 0.15,
## $ Gene_expression &lt;dbl&gt; -0.24, -0.13, -0.21, -0.15, -0.05, -0.05, 0.20, 0.24,</code></pre></div>
<div id="combining-pivot_longer-with-summarise" class="section level3">
<h3><span class="header-section-number">E.4.1</span> Combining <code>pivot_longer()</code> with <code>summarise()</code></h3>
<p>Here's a particularly powerful combination of <code>tidyverse()</code> functions you can use when you're exploring a new dataset: calculate summary statistics on all of your variables with <code>summarise(across(...))</code>, tidy the results with <code>pivot_longer()</code>, then create a faceted <code>ggplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lizard_smry_by_color =<span class="st"> </span>lizards <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Group the data by color morph</span>
<span class="st">  </span><span class="kw">group_by</span>(Color_morph) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(
    <span class="kw">across</span>(<span class="kw">where</span>(is.numeric), <span class="co"># For all numeric columns...</span>
           <span class="kw">list</span>(<span class="dt">Mean =</span> mean, <span class="dt">Med =</span> median, <span class="dt">SD =</span> sd)
           <span class="co"># run mean(), meidan(), and sd() on each group &amp; variable</span>
           <span class="co"># Note that the list elements follows the pattern Name = function</span>
    ),<span class="dt">N =</span> <span class="kw">n</span>() ) <span class="co"># This is outside of across, since it&#39;s only run once per group</span>
## `summarise()` ungrouping output (override with `.groups` argument)
<span class="kw">glimpse</span>(lizard_smry_by_color)
## Rows: 3
## Columns: 20
## $ Color_morph   &lt;chr&gt; &quot;Blue&quot;, &quot;Brown&quot;, &quot;Green&quot;
## $ Limb_Mean     &lt;dbl&gt; 13.08791, 13.27692, 13.11584
## $ Limb_Med      &lt;dbl&gt; 13.1, 13.1, 12.8
## $ Limb_SD       &lt;dbl&gt; 1.802216, 1.778345, 1.911442
## $ Mass_Mean     &lt;dbl&gt; 6.955116, 7.118371, 6.997738
## $ Mass_Med      &lt;dbl&gt; 6.92, 7.09, 6.99
## $ Mass_SD       &lt;dbl&gt; 1.067424, 1.097275, 1.098401
## $ Diameter_Mean &lt;dbl&gt; 32.88372, 24.11765, 11.47511
## $ Diameter_Med  &lt;dbl&gt; 33, 24, 11
## $ Diameter_SD   &lt;dbl&gt; 5.495152, 4.539194, 5.132390
## $ Height_Mean   &lt;dbl&gt; 171.2744, 167.2534, 167.7557
## $ Height_Med    &lt;dbl&gt; 184, 172, 175
## $ Height_SD     &lt;dbl&gt; 43.11129, 41.40915, 43.63552
## $ SVL_Mean      &lt;dbl&gt; 60.28000, 61.55928, 60.40633
## $ SVL_Med       &lt;dbl&gt; 59.5, 60.9, 57.9
## $ SVL_SD        &lt;dbl&gt; 8.741475, 8.349435, 9.006788
## $ Tail_Mean     &lt;dbl&gt; 56.90837, 57.97647, 57.75385
## $ Tail_Med      &lt;dbl&gt; 56.3, 58.0, 58.2
## $ Tail_SD       &lt;dbl&gt; 12.46141, 11.69319, 12.25767
## $ N             &lt;int&gt; 215, 221, 221</code></pre></div>
<p>This creates a data frame with columns for the color, the sample size, and a bunch that follow the pattern <code>Trait_statistic</code>. An ideal way to tidy these data would be reduce these columns into <code>Trait</code>, <code>Mean</code>, <code>Median</code>, and <code>SD</code>. We can do that like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lizard_smry_tidy =<span class="st"> </span>lizard_smry_by_color <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">c</span>(Color_morph, N), <span class="co"># exclude the columns</span>
               <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;.value&quot;</span>),
               <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SE =</span> SD<span class="op">/</span><span class="kw">sqrt</span>(N)) <span class="co"># may as well calculate standard error while we&#39;re here</span>
<span class="kw">View</span>(lizard_smry_tidy)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Color_morph
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:left;">
Trait
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Med
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
SE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
Limb
</td>
<td style="text-align:right;">
13.087907
</td>
<td style="text-align:right;">
13.10
</td>
<td style="text-align:right;">
1.802216
</td>
<td style="text-align:right;">
0.1229101
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
Mass
</td>
<td style="text-align:right;">
6.955116
</td>
<td style="text-align:right;">
6.92
</td>
<td style="text-align:right;">
1.067424
</td>
<td style="text-align:right;">
0.0727977
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
Diameter
</td>
<td style="text-align:right;">
32.883721
</td>
<td style="text-align:right;">
33.00
</td>
<td style="text-align:right;">
5.495152
</td>
<td style="text-align:right;">
0.3747663
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
Height
</td>
<td style="text-align:right;">
171.274419
</td>
<td style="text-align:right;">
184.00
</td>
<td style="text-align:right;">
43.111289
</td>
<td style="text-align:right;">
2.9401655
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
SVL
</td>
<td style="text-align:right;">
60.280000
</td>
<td style="text-align:right;">
59.50
</td>
<td style="text-align:right;">
8.741475
</td>
<td style="text-align:right;">
0.5961636
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:left;">
Tail
</td>
<td style="text-align:right;">
56.908372
</td>
<td style="text-align:right;">
56.30
</td>
<td style="text-align:right;">
12.461410
</td>
<td style="text-align:right;">
0.8498611
</td>
</tr>
<tr>
<td style="text-align:left;">
Brown
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:left;">
Limb
</td>
<td style="text-align:right;">
13.276923
</td>
<td style="text-align:right;">
13.10
</td>
<td style="text-align:right;">
1.778345
</td>
<td style="text-align:right;">
0.1196244
</td>
</tr>
<tr>
<td style="text-align:left;">
Brown
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:left;">
Mass
</td>
<td style="text-align:right;">
7.118371
</td>
<td style="text-align:right;">
7.09
</td>
<td style="text-align:right;">
1.097275
</td>
<td style="text-align:right;">
0.0738107
</td>
</tr>
<tr>
<td style="text-align:left;">
Brown
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:left;">
Diameter
</td>
<td style="text-align:right;">
24.117647
</td>
<td style="text-align:right;">
24.00
</td>
<td style="text-align:right;">
4.539193
</td>
<td style="text-align:right;">
0.3053392
</td>
</tr>
<tr>
<td style="text-align:left;">
Brown
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:left;">
Height
</td>
<td style="text-align:right;">
167.253394
</td>
<td style="text-align:right;">
172.00
</td>
<td style="text-align:right;">
41.409145
</td>
<td style="text-align:right;">
2.7854805
</td>
</tr>
</tbody>
</table>
</div>
<p>This call didn't have a <code>values_to</code> argument in it; instead, one of the <code>names_to</code> was listed as <code>&quot;.value&quot;</code>. This is a special indicator that tells pivot_longer to create one column for each matching name and place the corresponding values into it.</p>
<p>From here, you can make a nice little summary statistic plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lizard_smry_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Color_morph)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Trait, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># SD:</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Mean <span class="op">-</span><span class="st"> </span>SD, <span class="dt">ymax =</span> Mean <span class="op">+</span><span class="st"> </span>SD), <span class="dt">color =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Confidence Interval:</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Mean <span class="op">-</span><span class="st"> </span>SE <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span>, <span class="dt">ymax =</span> Mean <span class="op">+</span><span class="st"> </span>SE <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span>), 
                <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">width =</span> .<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Mean</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Mean), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Trait Mean, SD, and 95% CI&quot;</span>) </code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/pivot_sumarise_3-1.png" width="672" /></p>
</div>
</div>
<div id="pivot-wider-tutorial" class="section level2">
<h2><span class="header-section-number">E.5</span> Going from many rows to many columns: <code>pivot_wider()</code></h2>
<p>(In progress)</p>
</div>
<div id="combining-data-frames-in-progress" class="section level2">
<h2><span class="header-section-number">E.6</span> Combining data frames (In Progress)</h2>
<div id="binding-rows" class="section level3">
<h3><span class="header-section-number">E.6.1</span> Binding rows</h3>
</div>
<div id="binding-columns-by-position" class="section level3">
<h3><span class="header-section-number">E.6.2</span> Binding columns by position</h3>
</div>
<div id="joining-rows-by-value" class="section level3">
<h3><span class="header-section-number">E.6.3</span> Joining rows by value</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-analysis-tutorial.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
