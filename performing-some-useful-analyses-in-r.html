<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>D Performing some useful analyses in R | Bio 373L Survival Guide</title>
  <meta name="description" content="Writing advice for Field Ecology." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="D Performing some useful analyses in R | Bio 373L Survival Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Writing advice for Field Ecology." />
  <meta name="github-repo" content="Christopher-Peterson/Bio373L-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="D Performing some useful analyses in R | Bio 373L Survival Guide" />
  
  <meta name="twitter:description" content="Writing advice for Field Ecology." />
  

<meta name="author" content="Christopher R. Peterson" />


<meta name="date" content="2020-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation-with-dplyr.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bio 373L Survival Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>1</b> Writing Lab Reports: Structure</a><ul>
<li class="chapter" data-level="1.1" data-path="structure.html"><a href="structure.html#structure-overview"><i class="fa fa-check"></i><b>1.1</b> Structure Overview</a></li>
<li class="chapter" data-level="1.2" data-path="structure.html"><a href="structure.html#abstract"><i class="fa fa-check"></i><b>1.2</b> Abstract</a></li>
<li class="chapter" data-level="1.3" data-path="structure.html"><a href="structure.html#introduction"><i class="fa fa-check"></i><b>1.3</b> Introduction</a></li>
<li class="chapter" data-level="1.4" data-path="structure.html"><a href="structure.html#methods"><i class="fa fa-check"></i><b>1.4</b> Methods</a></li>
<li class="chapter" data-level="1.5" data-path="structure.html"><a href="structure.html#results"><i class="fa fa-check"></i><b>1.5</b> Results</a><ul>
<li class="chapter" data-level="1.5.1" data-path="structure.html"><a href="structure.html#reporting-statistics"><i class="fa fa-check"></i><b>1.5.1</b> Reporting statistics</a></li>
<li class="chapter" data-level="1.5.2" data-path="structure.html"><a href="structure.html#do-not-interpret-your-data-here"><i class="fa fa-check"></i><b>1.5.2</b> Do not interpret your data here</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="structure.html"><a href="structure.html#discussion"><i class="fa fa-check"></i><b>1.6</b> Discussion</a></li>
<li class="chapter" data-level="1.7" data-path="structure.html"><a href="structure.html#literature-cited"><i class="fa fa-check"></i><b>1.7</b> Literature Cited</a></li>
<li class="chapter" data-level="1.8" data-path="structure.html"><a href="structure.html#common-mistakes-for-particular-sections"><i class="fa fa-check"></i><b>1.8</b> Common Mistakes for particular sections</a><ul>
<li class="chapter" data-level="1.8.1" data-path="structure.html"><a href="structure.html#introduction-and-discussion"><i class="fa fa-check"></i><b>1.8.1</b> Introduction and Discussion</a></li>
<li class="chapter" data-level="1.8.2" data-path="structure.html"><a href="structure.html#results-1"><i class="fa fa-check"></i><b>1.8.2</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="style.html"><a href="style.html"><i class="fa fa-check"></i><b>2</b> Writing Lab Reports: Style</a><ul>
<li class="chapter" data-level="2.1" data-path="style.html"><a href="style.html#be-concise"><i class="fa fa-check"></i><b>2.1</b> Be Concise</a></li>
<li class="chapter" data-level="2.2" data-path="style.html"><a href="style.html#sentence-structure"><i class="fa fa-check"></i><b>2.2</b> Sentence Structure</a></li>
<li class="chapter" data-level="2.3" data-path="style.html"><a href="style.html#passive-voice"><i class="fa fa-check"></i><b>2.3</b> Passive Voice</a></li>
<li class="chapter" data-level="2.4" data-path="style.html"><a href="style.html#word-choice"><i class="fa fa-check"></i><b>2.4</b> Word Choice</a></li>
<li class="chapter" data-level="2.5" data-path="style.html"><a href="style.html#scientific-and-common-names"><i class="fa fa-check"></i><b>2.5</b> Scientific and Common Names</a></li>
<li class="chapter" data-level="2.6" data-path="style.html"><a href="style.html#other-grammar"><i class="fa fa-check"></i><b>2.6</b> Other Grammar</a></li>
<li class="chapter" data-level="2.7" data-path="style.html"><a href="style.html#commonly-confused-definitions"><i class="fa fa-check"></i><b>2.7</b> Commonly Confused Definitions</a></li>
<li class="chapter" data-level="2.8" data-path="style.html"><a href="style.html#significant-digits"><i class="fa fa-check"></i><b>2.8</b> Significant Digits</a></li>
<li class="chapter" data-level="2.9" data-path="style.html"><a href="style.html#tenses"><i class="fa fa-check"></i><b>2.9</b> Tenses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>3</b> Figures and Tables</a><ul>
<li class="chapter" data-level="3.1" data-path="figures.html"><a href="figures.html#captions"><i class="fa fa-check"></i><b>3.1</b> Captions</a></li>
<li class="chapter" data-level="3.2" data-path="figures.html"><a href="figures.html#figures"><i class="fa fa-check"></i><b>3.2</b> Figures</a><ul>
<li class="chapter" data-level="3.2.1" data-path="figures.html"><a href="figures.html#specific-figure-guidelines"><i class="fa fa-check"></i><b>3.2.1</b> Specific Figure Guidelines</a></li>
<li class="chapter" data-level="3.2.2" data-path="style.html"><a href="style.html#be-concise"><i class="fa fa-check"></i><b>3.2.2</b> Be Concise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="figures.html"><a href="figures.html#some-example-figures"><i class="fa fa-check"></i><b>3.3</b> Some Example Figures</a><ul>
<li class="chapter" data-level="3.3.1" data-path="figures.html"><a href="figures.html#general-formatting"><i class="fa fa-check"></i><b>3.3.1</b> General Formatting</a></li>
<li class="chapter" data-level="3.3.2" data-path="figures.html"><a href="figures.html#continuous-response-categorical-predictors"><i class="fa fa-check"></i><b>3.3.2</b> Continuous response, categorical predictors</a></li>
<li class="chapter" data-level="3.3.3" data-path="figures.html"><a href="figures.html#categorical-count-or-frequency-responses"><i class="fa fa-check"></i><b>3.3.3</b> Categorical, count, or frequency responses</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="figures.html"><a href="figures.html#tables"><i class="fa fa-check"></i><b>3.4</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>4</b> Lab 1: Succession</a><ul>
<li class="chapter" data-level="4.1" data-path="lab1.html"><a href="lab1.html#introduction-to-the-lab"><i class="fa fa-check"></i><b>4.1</b> Introduction to the lab</a></li>
<li class="chapter" data-level="4.2" data-path="lab1.html"><a href="lab1.html#materials-and-methods"><i class="fa fa-check"></i><b>4.2</b> Materials and Methods</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lab1.html"><a href="lab1.html#bfl-habitat-regions"><i class="fa fa-check"></i><b>4.2.1</b> BFL habitat regions</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab1.html"><a href="lab1.html#data-collection"><i class="fa fa-check"></i><b>4.2.2</b> Data Collection</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab1.html"><a href="lab1.html#analysis-to-perform"><i class="fa fa-check"></i><b>4.3</b> Analysis to perform</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lab1.html"><a href="lab1.html#canopy-tree-density"><i class="fa fa-check"></i><b>4.3.1</b> Canopy tree density</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab1.html"><a href="lab1.html#species-by-habitat-and-life-stage"><i class="fa fa-check"></i><b>4.3.2</b> Species by habitat and life stage</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="structure.html"><a href="structure.html#discussion"><i class="fa fa-check"></i><b>4.4</b> Discussion</a></li>
<li class="chapter" data-level="4.5" data-path="lab1.html"><a href="lab1.html#general-comments-post-review"><i class="fa fa-check"></i><b>4.5</b> General Comments (Post-Review)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="figures.html"><a href="figures.html#figures"><i class="fa fa-check"></i><b>4.5.1</b> Figures</a></li>
<li class="chapter" data-level="4.5.2" data-path="lab1.html"><a href="lab1.html#write-this-like-youre-trying-to-publish-it"><i class="fa fa-check"></i><b>4.5.2</b> Write this like you're trying to publish it</a></li>
<li class="chapter" data-level="4.5.3" data-path="lab1.html"><a href="lab1.html#describe-the-habitats"><i class="fa fa-check"></i><b>4.5.3</b> Describe the habitats</a></li>
<li class="chapter" data-level="4.5.4" data-path="lab1.html"><a href="lab1.html#the-analysis"><i class="fa fa-check"></i><b>4.5.4</b> The Analysis</a></li>
<li class="chapter" data-level="4.5.5" data-path="lab1.html"><a href="lab1.html#keeping-things-in-the-right-sections"><i class="fa fa-check"></i><b>4.5.5</b> Keeping things in the right sections</a></li>
<li class="chapter" data-level="4.5.6" data-path="lab1.html"><a href="lab1.html#basic-style-and-format-rules"><i class="fa fa-check"></i><b>4.5.6</b> Basic style and format rules</a></li>
<li class="chapter" data-level="4.5.7" data-path="lab1.html"><a href="lab1.html#other-comments"><i class="fa fa-check"></i><b>4.5.7</b> Other Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Lab2.html"><a href="Lab2.html"><i class="fa fa-check"></i><b>5</b> Lab 2: Woodland Heterogeneity</a><ul>
<li class="chapter" data-level="5.1" data-path="Lab2.html"><a href="Lab2.html#introduction-background"><i class="fa fa-check"></i><b>5.1</b> Introduction &amp; background</a></li>
<li class="chapter" data-level="5.2" data-path="Lab2.html"><a href="Lab2.html#questions-and-hypotheses"><i class="fa fa-check"></i><b>5.2</b> Questions and Hypotheses</a></li>
<li class="chapter" data-level="5.3" data-path="Lab2.html"><a href="Lab2.html#field-methods"><i class="fa fa-check"></i><b>5.3</b> Field Methods</a></li>
<li class="chapter" data-level="5.4" data-path="Lab2.html"><a href="Lab2.html#analyses"><i class="fa fa-check"></i><b>5.4</b> Analyses</a><ul>
<li class="chapter" data-level="5.4.1" data-path="Lab2.html"><a href="Lab2.html#calibrating-canopy-estimates"><i class="fa fa-check"></i><b>5.4.1</b> Calibrating canopy estimates</a></li>
<li class="chapter" data-level="5.4.2" data-path="Lab2.html"><a href="Lab2.html#relationship-between-canopy-and-ground-cover"><i class="fa fa-check"></i><b>5.4.2</b> Relationship between canopy and ground cover</a></li>
<li class="chapter" data-level="5.4.3" data-path="Lab2.html"><a href="Lab2.html#quantifying-the-spatial-mosaic"><i class="fa fa-check"></i><b>5.4.3</b> Quantifying the spatial mosaic</a></li>
<li class="chapter" data-level="5.4.4" data-path="Lab2.html"><a href="Lab2.html#historical-trends"><i class="fa fa-check"></i><b>5.4.4</b> Historical Trends</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="working-with-r.html"><a href="working-with-r.html"><i class="fa fa-check"></i><b>A</b> Working with R</a><ul>
<li class="chapter" data-level="A.1" data-path="working-with-r.html"><a href="working-with-r.html#introduction-to-rstudio"><i class="fa fa-check"></i><b>A.1</b> Introduction to RStudio</a><ul>
<li class="chapter" data-level="A.1.1" data-path="working-with-r.html"><a href="working-with-r.html#rstudio-projects"><i class="fa fa-check"></i><b>A.1.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="A.1.2" data-path="working-with-r.html"><a href="working-with-r.html#customizing-rstudio"><i class="fa fa-check"></i><b>A.1.2</b> Customizing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="working-with-r.html"><a href="working-with-r.html#r-basics"><i class="fa fa-check"></i><b>A.2</b> R basics</a><ul>
<li class="chapter" data-level="A.2.1" data-path="working-with-r.html"><a href="working-with-r.html#statements-vectors"><i class="fa fa-check"></i><b>A.2.1</b> Statements &amp; vectors</a></li>
<li class="chapter" data-level="A.2.2" data-path="working-with-r.html"><a href="working-with-r.html#variables"><i class="fa fa-check"></i><b>A.2.2</b> Variables</a></li>
<li class="chapter" data-level="A.2.3" data-path="working-with-r.html"><a href="working-with-r.html#reading-working-with-data-frames"><i class="fa fa-check"></i><b>A.2.3</b> Reading &amp; working with data frames</a></li>
<li class="chapter" data-level="A.2.4" data-path="working-with-r.html"><a href="working-with-r.html#functions"><i class="fa fa-check"></i><b>A.2.4</b> Functions</a></li>
<li class="chapter" data-level="A.2.5" data-path="working-with-r.html"><a href="working-with-r.html#getting-help"><i class="fa fa-check"></i><b>A.2.5</b> Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>B</b> Making graphs in R with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="B.1" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#components-of-a-plot"><i class="fa fa-check"></i><b>B.1</b> Components of a plot</a></li>
<li class="chapter" data-level="B.2" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#aesthetics-and-scales"><i class="fa fa-check"></i><b>B.2</b> Aesthetics and scales</a><ul>
<li class="chapter" data-level="B.2.1" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#color"><i class="fa fa-check"></i><b>B.2.1</b> Color</a></li>
<li class="chapter" data-level="B.2.2" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#shape"><i class="fa fa-check"></i><b>B.2.2</b> Shape</a></li>
<li class="chapter" data-level="B.2.3" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>B.2.3</b> Size</a></li>
<li class="chapter" data-level="B.2.4" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#fixed-aesthetics"><i class="fa fa-check"></i><b>B.2.4</b> Fixed aesthetics</a></li>
<li class="chapter" data-level="B.2.5" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#combining-aesthetics"><i class="fa fa-check"></i><b>B.2.5</b> Combining aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#geometry"><i class="fa fa-check"></i><b>B.3</b> Geometry</a><ul>
<li class="chapter" data-level="B.3.1" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#continuous-x-no-y"><i class="fa fa-check"></i><b>B.3.1</b> Continuous X, no Y</a></li>
<li class="chapter" data-level="B.3.2" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#discrete-x-continuous-y"><i class="fa fa-check"></i><b>B.3.2</b> Discrete X, continuous Y</a></li>
<li class="chapter" data-level="B.3.3" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#continuous-x-and-y"><i class="fa fa-check"></i><b>B.3.3</b> Continuous X and Y</a></li>
<li class="chapter" data-level="B.3.4" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#time-series-data"><i class="fa fa-check"></i><b>B.3.4</b> Time series data</a></li>
<li class="chapter" data-level="B.3.5" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#discrete-x-and-y"><i class="fa fa-check"></i><b>B.3.5</b> Discrete X and Y</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>B.4</b> Facets</a></li>
<li class="chapter" data-level="B.5" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#changing-the-theme-axis-titles-other-visual-elements"><i class="fa fa-check"></i><b>B.5</b> Changing the theme, axis titles, &amp; other visual elements</a></li>
<li class="chapter" data-level="B.6" data-path="making-graphs-in-r-with-ggplot2.html"><a href="making-graphs-in-r-with-ggplot2.html#more-references"><i class="fa fa-check"></i><b>B.6</b> More references</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>C</b> Data manipulation with <code>dplyr</code></a><ul>
<li class="chapter" data-level="C.1" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#the-pipe"><i class="fa fa-check"></i><b>C.1</b> The Pipe (%&gt;%)</a></li>
<li class="chapter" data-level="C.2" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#addingmodifying-columns-mutate"><i class="fa fa-check"></i><b>C.2</b> Adding/modifying columns (mutate)</a></li>
<li class="chapter" data-level="C.3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#subsetting-by-row-filter"><i class="fa fa-check"></i><b>C.3</b> Subsetting by row (filter)</a></li>
<li class="chapter" data-level="C.4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#subsetting-by-column-select"><i class="fa fa-check"></i><b>C.4</b> Subsetting by column (select)</a></li>
<li class="chapter" data-level="C.5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#sorting-by-columns-arrange"><i class="fa fa-check"></i><b>C.5</b> Sorting by columns (arrange)</a></li>
<li class="chapter" data-level="C.6" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#summarizing-data"><i class="fa fa-check"></i><b>C.6</b> Summarizing data</a></li>
<li class="chapter" data-level="C.7" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#group-operations"><i class="fa fa-check"></i><b>C.7</b> Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html"><i class="fa fa-check"></i><b>D</b> Performing some useful analyses in R</a><ul>
<li class="chapter" data-level="D.1" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#a-note-on-factors"><i class="fa fa-check"></i><b>D.1</b> A note on factors</a></li>
<li class="chapter" data-level="D.2" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#comparing-categorical-frequencies-contingency-tables-related-analyses"><i class="fa fa-check"></i><b>D.2</b> Comparing categorical frequencies (Contingency Tables &amp; related analyses)</a><ul>
<li class="chapter" data-level="D.2.1" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#contingency-tables"><i class="fa fa-check"></i><b>D.2.1</b> Contingency Tables</a></li>
<li class="chapter" data-level="D.2.2" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#chi-squared-fishers-exact-tests"><i class="fa fa-check"></i><b>D.2.2</b> Chi-squared &amp; Fisher's Exact Tests</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#comparing-two-means-t-tests"><i class="fa fa-check"></i><b>D.3</b> Comparing two means (t-tests)</a></li>
<li class="chapter" data-level="D.4" data-path="performing-some-useful-analyses-in-r.html"><a href="performing-some-useful-analyses-in-r.html#advanced-workflow-tips"><i class="fa fa-check"></i><b>D.4</b> Advanced workflow tips</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bio 373L Survival Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="performing-some-useful-analyses-in-r" class="section level1">
<h1><span class="header-section-number">D</span> Performing some useful analyses in R</h1>
<p>I'm going to give some examples of how to do common analyses you'll need for this class. I won't be spending much time on the statistical assumptions or diagnostics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse) 
<span class="kw">library</span>(cowplot)
<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>())
lizards &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;example_data/anoles.csv&quot;</span>) <span class="co"># See Appendix A if you don&#39;t have this data</span></code></pre></div>
<div id="a-note-on-factors" class="section level2">
<h2><span class="header-section-number">D.1</span> A note on factors</h2>
<p>R has two ways of representing textual data: character vectors (also called strings) and factors.</p>
<ul>
<li>Character vectors are just text; they have no inherent underlying meaning.</li>
<li>Factors are a data type with a specific number of levels; they're often used to represent different experimental treatments. Examples could include {low, medium, high} or {control, treatment}. Each level of a factor is associated with a number.</li>
</ul>
<p>For the most part, it's easier and safer to work with character vectors. Most functions we'll be using know how to convert them when it's necessary.</p>
<p>One important thing to note is that <code>ggplot</code> arranges character vectors alphabetically on its categorical scales, but orders factors by their level number. Thus, to change the order of categorical x-axes (and other scales), you need to make your categories into a factor. This is done with the <code>fct_inorder</code>, <code>fct_infreq</code>, and related functions, which are part of the <code>forcats</code> package and loaded with tidyverse. The easiest one to use is <code>fct_inorder</code>, which changes the level values to be in the order of your data; when combined with <code>arrange()</code> and other <code>dplyr</code> functions, this is quite flexible and powerful. For more information on these and other factor functions, take a look at the <a href="http://forcats.tidyverse.org">forcats website</a>.</p>
<p>If you want to manually create a factor, you can use the <code>factor</code> command, which is in base R (no package).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">color_levels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Red&quot;</span>,<span class="st">&quot;Green&quot;</span>,<span class="st">&quot;Blue&quot;</span>)
<span class="co"># Randomly select 20 colors from color_levels</span>
color_example =<span class="st"> </span><span class="kw">sample</span>(color_levels, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
color_example
##  [1] &quot;Green&quot; &quot;Blue&quot;  &quot;Green&quot; &quot;Green&quot; &quot;Blue&quot;  &quot;Green&quot; &quot;Green&quot; &quot;Green&quot; &quot;Blue&quot; 
## [10] &quot;Blue&quot;  &quot;Red&quot;   &quot;Blue&quot;  &quot;Green&quot; &quot;Green&quot; &quot;Blue&quot;  &quot;Green&quot; &quot;Red&quot;   &quot;Blue&quot; 
## [19] &quot;Blue&quot;  &quot;Blue&quot;

<span class="co"># Convert it into a factor</span>
color_as_factor =<span class="st"> </span><span class="kw">factor</span>(color_example, <span class="dt">levels =</span> color_levels)
color_as_factor
##  [1] Green Blue  Green Green Blue  Green Green Green Blue  Blue  Red   Blue 
## [13] Green Green Blue  Green Red   Blue  Blue  Blue 
## Levels: Red Green Blue</code></pre></div>
</div>
<div id="comparing-categorical-frequencies-contingency-tables-related-analyses" class="section level2">
<h2><span class="header-section-number">D.2</span> Comparing categorical frequencies (Contingency Tables &amp; related analyses)</h2>
<p>These tests generally compare the frequencies of count data.</p>
<div id="contingency-tables" class="section level3">
<h3><span class="header-section-number">D.2.1</span> Contingency Tables</h3>
<p>The easiest way to make a contingency table is from a data frame where each column is a categorical variable you want in the table &amp; each row is an observation. Let's say we wanted to create a color morph by perch type contingency with our lizard data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">color_by_perch_tbl =<span class="st"> </span>lizards <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Color_morph, Perch_type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># select only the columns you want</span>
<span class="st">  </span><span class="kw">table</span>()  <span class="co"># feed them into the table command</span>
color_by_perch_tbl</code></pre></div>
<pre><code>##            Perch_type
## Color_morph Building Other Shrub Tree
##       Blue        17    41    27  130
##       Brown       31    25    25  140
##       Green       30    25    32  134</code></pre>
<p>If you want to switch your contingency table from counts to frequencies, just divide it by its sum:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">color_by_perch_tbl <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(color_by_perch_tbl)</code></pre></div>
<pre><code>##            Perch_type
## Color_morph   Building      Other      Shrub       Tree
##       Blue  0.02587519 0.06240487 0.04109589 0.19786910
##       Brown 0.04718417 0.03805175 0.03805175 0.21308980
##       Green 0.04566210 0.03805175 0.04870624 0.20395738</code></pre>
</div>
<div id="chi-squared-fishers-exact-tests" class="section level3">
<h3><span class="header-section-number">D.2.2</span> Chi-squared &amp; Fisher's Exact Tests</h3>
<p>Once you have a contingency table, you can test for independence between the rows and columns. This provides you with your test statistic (<code>X-squared</code>), degrees of freedom, and p-value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(color_by_perch_tbl)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  color_by_perch_tbl
## X-squared = 11.603, df = 6, p-value = 0.07143</code></pre>
<p>Chi-squared tests assume that there's at least five observations in each cell of the contingency table. If this fails, then the resulting values aren't accurate. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">site_a_contingency =<span class="st"> </span>lizards <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Site <span class="op">==</span><span class="st"> &quot;A&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># cut down the data size</span>
<span class="st">  </span><span class="kw">select</span>(Color_morph, Perch_type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># select only the columns you want</span>
<span class="st">  </span><span class="kw">table</span>()  <span class="co"># feed them into the table command</span>
<span class="kw">print</span>(site_a_contingency)
##            Perch_type
## Color_morph Building Other Shrub Tree
##       Blue         1     3     1    5
##       Brown        0     0     2   11
##       Green        1     1     0    1
<span class="kw">chisq.test</span>(site_a_contingency)
## Warning in chisq.test(site_a_contingency): Chi-squared approximation may be
## incorrect
## 
##  Pearson&#39;s Chi-squared test
## 
## data:  site_a_contingency
## X-squared = 9.752, df = 6, p-value = 0.1355</code></pre></div>
<p>Note the warning that &quot;Chi-squared approximation may be incorrect.&quot; In this case, it's a good idea to run the Fisher's exact test, it investigates the same null hypotheses, but works with low counts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(site_a_contingency)</code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  site_a_contingency
## p-value = 0.06251
## alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div id="comparing-two-means-t-tests" class="section level2">
<h2><span class="header-section-number">D.3</span> Comparing two means (t-tests)</h2>
<p>(In progress) ## Linear Regression and ANOVA</p>
<p>(In progress)</p>
</div>
<div id="advanced-workflow-tips" class="section level2">
<h2><span class="header-section-number">D.4</span> Advanced workflow tips</h2>
<p>(In progress)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-with-dplyr.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
