<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Making graphs in R with ggplot2 | Bio 373L Survival Guide</title>
  <meta name="description" content="Lab Manual for Field Ecology (Bio 373L) at UT Austin." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Making graphs in R with ggplot2 | Bio 373L Survival Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lab Manual for Field Ecology (Bio 373L) at UT Austin." />
  <meta name="github-repo" content="Christopher-Peterson/Bio373L-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Making graphs in R with ggplot2 | Bio 373L Survival Guide" />
  
  <meta name="twitter:description" content="Lab Manual for Field Ecology (Bio 373L) at UT Austin." />
  

<meta name="author" content="Christopher R. Peterson" />


<meta name="date" content="2022-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-intro.html"/>
<link rel="next" href="r-dplyr.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bio 373L Survival Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Writing Lab Reports</b></span></li>
<li class="chapter" data-level="1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>1</b> The Structure of a Scientific Manuscript</a>
<ul>
<li class="chapter" data-level="1.1" data-path="structure.html"><a href="structure.html#full-manuscripts"><i class="fa fa-check"></i><b>1.1</b> Full Manuscripts</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="structure.html"><a href="structure.html#title"><i class="fa fa-check"></i><b>1.1.1</b> Title</a></li>
<li class="chapter" data-level="1.1.2" data-path="structure.html"><a href="structure.html#abstract-key"><i class="fa fa-check"></i><b>1.1.2</b> Abstract (key)</a></li>
<li class="chapter" data-level="1.1.3" data-path="structure.html"><a href="structure.html#introduction"><i class="fa fa-check"></i><b>1.1.3</b> Introduction</a></li>
<li class="chapter" data-level="1.1.4" data-path="structure.html"><a href="structure.html#methods"><i class="fa fa-check"></i><b>1.1.4</b> Methods</a></li>
<li class="chapter" data-level="1.1.5" data-path="structure.html"><a href="structure.html#results"><i class="fa fa-check"></i><b>1.1.5</b> Results</a></li>
<li class="chapter" data-level="1.1.6" data-path="structure.html"><a href="structure.html#discussion"><i class="fa fa-check"></i><b>1.1.6</b> Discussion</a></li>
<li class="chapter" data-level="1.1.7" data-path="structure.html"><a href="structure.html#literature"><i class="fa fa-check"></i><b>1.1.7</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="structure.html"><a href="structure.html#preliminary-manuscripts"><i class="fa fa-check"></i><b>1.2</b> Preliminary Manuscripts</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure.html"><a href="structure.html#the-five-paragraphs"><i class="fa fa-check"></i><b>1.2.1</b> The Five Paragraphs</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure.html"><a href="structure.html#list-of-methods-analyses"><i class="fa fa-check"></i><b>1.2.2</b> List of Methods &amp; Analyses</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="structure.html"><a href="structure.html#figures-and-tables"><i class="fa fa-check"></i><b>1.3</b> Figures and Tables</a></li>
<li class="chapter" data-level="1.4" data-path="structure.html"><a href="structure.html#citationsreferences"><i class="fa fa-check"></i><b>1.4</b> Citations/References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="style.html"><a href="style.html"><i class="fa fa-check"></i><b>2</b> Content and Style of an Effective Manuscript</a>
<ul>
<li class="chapter" data-level="2.1" data-path="style.html"><a href="style.html#be-concise"><i class="fa fa-check"></i><b>2.1</b> Be Concise</a></li>
<li class="chapter" data-level="2.2" data-path="style.html"><a href="style.html#sentence-structure"><i class="fa fa-check"></i><b>2.2</b> Sentence Structure</a></li>
<li class="chapter" data-level="2.3" data-path="style.html"><a href="style.html#passive-voice"><i class="fa fa-check"></i><b>2.3</b> Passive Voice</a></li>
<li class="chapter" data-level="2.4" data-path="style.html"><a href="style.html#style_lit"><i class="fa fa-check"></i><b>2.4</b> Using the literature in your paper (This is a common source of mistakes)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="style.html"><a href="style.html#be-specific-and-concice-with-your-citations"><i class="fa fa-check"></i><b>2.4.1</b> Be specific and concice with your citations</a></li>
<li class="chapter" data-level="2.4.2" data-path="style.html"><a href="style.html#do-not-include-direct-quotes-from-the-literature"><i class="fa fa-check"></i><b>2.4.2</b> Do not include direct quotes from the literature</a></li>
<li class="chapter" data-level="2.4.3" data-path="style.html"><a href="style.html#where-citations-belong"><i class="fa fa-check"></i><b>2.4.3</b> Where citations belong</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="style.html"><a href="style.html#word-choice"><i class="fa fa-check"></i><b>2.5</b> Word Choice</a></li>
<li class="chapter" data-level="2.6" data-path="style.html"><a href="style.html#scientific-and-common-names"><i class="fa fa-check"></i><b>2.6</b> Scientific and Common Names</a></li>
<li class="chapter" data-level="2.7" data-path="style.html"><a href="style.html#other-grammar"><i class="fa fa-check"></i><b>2.7</b> Other Grammar</a></li>
<li class="chapter" data-level="2.8" data-path="style.html"><a href="style.html#commonly-confused-definitions"><i class="fa fa-check"></i><b>2.8</b> Commonly Confused Definitions</a></li>
<li class="chapter" data-level="2.9" data-path="style.html"><a href="style.html#significant-digits"><i class="fa fa-check"></i><b>2.9</b> Significant Digits</a></li>
<li class="chapter" data-level="2.10" data-path="style.html"><a href="style.html#tenses"><i class="fa fa-check"></i><b>2.10</b> Tenses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>3</b> Figures and Tables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="figures.html"><a href="figures.html#captions"><i class="fa fa-check"></i><b>3.1</b> Captions</a></li>
<li class="chapter" data-level="3.2" data-path="figures.html"><a href="figures.html#figures-1"><i class="fa fa-check"></i><b>3.2</b> Figures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="figures.html"><a href="figures.html#specific-figure-guidelines"><i class="fa fa-check"></i><b>3.2.1</b> Specific Figure Guidelines</a></li>
<li class="chapter" data-level="3.2.2" data-path="figures.html"><a href="figures.html#be-concise-1"><i class="fa fa-check"></i><b>3.2.2</b> Be Concise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="figures.html"><a href="figures.html#some-example-figures"><i class="fa fa-check"></i><b>3.3</b> Some Example Figures</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="figures.html"><a href="figures.html#general-formatting"><i class="fa fa-check"></i><b>3.3.1</b> General Formatting</a></li>
<li class="chapter" data-level="3.3.2" data-path="figures.html"><a href="figures.html#continuous-response-categorical-predictors"><i class="fa fa-check"></i><b>3.3.2</b> Continuous response, categorical predictors</a></li>
<li class="chapter" data-level="3.3.3" data-path="figures.html"><a href="figures.html#categorical-count-or-frequency-responses"><i class="fa fa-check"></i><b>3.3.3</b> Categorical, count, or frequency responses</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="figures.html"><a href="figures.html#tables"><i class="fa fa-check"></i><b>3.4</b> Tables</a></li>
</ul></li>
<li class="part"><span><b>II Data Analysis in R</b></span></li>
<li class="chapter" data-level="4" data-path="r-intro.html"><a href="r-intro.html"><i class="fa fa-check"></i><b>4</b> Working with R and RStudio</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-intro.html"><a href="r-intro.html#r-intro-rstudio"><i class="fa fa-check"></i><b>4.1</b> Introduction to RStudio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="r-intro.html"><a href="r-intro.html#rstudio-projects"><i class="fa fa-check"></i><b>4.1.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="4.1.2" data-path="r-intro.html"><a href="r-intro.html#customizing-rstudio"><i class="fa fa-check"></i><b>4.1.2</b> Customizing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="r-intro.html"><a href="r-intro.html#r-basics"><i class="fa fa-check"></i><b>4.2</b> R basics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r-intro.html"><a href="r-intro.html#statements-vectors"><i class="fa fa-check"></i><b>4.2.1</b> Statements &amp; vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="r-intro.html"><a href="r-intro.html#variables"><i class="fa fa-check"></i><b>4.2.2</b> Variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="r-intro.html"><a href="r-intro.html#reading-working-with-data-frames"><i class="fa fa-check"></i><b>4.2.3</b> Reading &amp; working with data frames</a></li>
<li class="chapter" data-level="4.2.4" data-path="r-intro.html"><a href="r-intro.html#functions"><i class="fa fa-check"></i><b>4.2.4</b> Functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="r-intro.html"><a href="r-intro.html#getting-help"><i class="fa fa-check"></i><b>4.2.5</b> Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-ggplot.html"><a href="r-ggplot.html"><i class="fa fa-check"></i><b>5</b> Making graphs in R with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-components"><i class="fa fa-check"></i><b>5.1</b> Components of a plot</a></li>
<li class="chapter" data-level="5.2" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes"><i class="fa fa-check"></i><b>5.2</b> Aesthetics and scales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes-color"><i class="fa fa-check"></i><b>5.2.1</b> Color</a></li>
<li class="chapter" data-level="5.2.2" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes-shape"><i class="fa fa-check"></i><b>5.2.2</b> Shape</a></li>
<li class="chapter" data-level="5.2.3" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes-size"><i class="fa fa-check"></i><b>5.2.3</b> Size</a></li>
<li class="chapter" data-level="5.2.4" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes-fixed"><i class="fa fa-check"></i><b>5.2.4</b> Fixed aesthetics</a></li>
<li class="chapter" data-level="5.2.5" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-aes-combined"><i class="fa fa-check"></i><b>5.2.5</b> Combining aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="r-ggplot.html"><a href="r-ggplot.html#geometry"><i class="fa fa-check"></i><b>5.3</b> Geometry</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-contx-noy"><i class="fa fa-check"></i><b>5.3.1</b> Continuous X, no Y</a></li>
<li class="chapter" data-level="5.3.2" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-discx-conty"><i class="fa fa-check"></i><b>5.3.2</b> Discrete X, continuous Y</a></li>
<li class="chapter" data-level="5.3.3" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-contx-conty"><i class="fa fa-check"></i><b>5.3.3</b> Continuous X and Y</a></li>
<li class="chapter" data-level="5.3.4" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-ts"><i class="fa fa-check"></i><b>5.3.4</b> Time series data</a></li>
<li class="chapter" data-level="5.3.5" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-discx-discy"><i class="fa fa-check"></i><b>5.3.5</b> Discrete X and Y</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-ggplot.html"><a href="r-ggplot.html#facets"><i class="fa fa-check"></i><b>5.4</b> Facets</a></li>
<li class="chapter" data-level="5.5" data-path="r-ggplot.html"><a href="r-ggplot.html#r-ggplot-tweaks"><i class="fa fa-check"></i><b>5.5</b> Changing the theme, axis titles, &amp; other visual elements</a></li>
<li class="chapter" data-level="5.6" data-path="r-ggplot.html"><a href="r-ggplot.html#more-references"><i class="fa fa-check"></i><b>5.6</b> More references</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-dplyr.html"><a href="r-dplyr.html"><i class="fa fa-check"></i><b>6</b> Data manipulation with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="6.1" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-pipe"><i class="fa fa-check"></i><b>6.1</b> The Pipe (%&gt;%)</a></li>
<li class="chapter" data-level="6.2" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-mutate"><i class="fa fa-check"></i><b>6.2</b> Adding/modifying columns (mutate)</a></li>
<li class="chapter" data-level="6.3" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-filter"><i class="fa fa-check"></i><b>6.3</b> Subsetting by row (filter)</a></li>
<li class="chapter" data-level="6.4" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-select"><i class="fa fa-check"></i><b>6.4</b> Subsetting by column (select)</a></li>
<li class="chapter" data-level="6.5" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-arrange"><i class="fa fa-check"></i><b>6.5</b> Sorting by columns (arrange)</a></li>
<li class="chapter" data-level="6.6" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-summarize"><i class="fa fa-check"></i><b>6.6</b> Summarizing data</a></li>
<li class="chapter" data-level="6.7" data-path="r-dplyr.html"><a href="r-dplyr.html#r-dplyr-group"><i class="fa fa-check"></i><b>6.7</b> Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-stats.html"><a href="r-stats.html"><i class="fa fa-check"></i><b>7</b> Performing some useful analyses in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-stats.html"><a href="r-stats.html#r-stats-factors"><i class="fa fa-check"></i><b>7.1</b> A note on factors</a></li>
<li class="chapter" data-level="7.2" data-path="r-stats.html"><a href="r-stats.html#r-stats-cat"><i class="fa fa-check"></i><b>7.2</b> Comparing categorical frequencies (Contingency Tables &amp; related analyses)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="r-stats.html"><a href="r-stats.html#r-stats-cont-tbl"><i class="fa fa-check"></i><b>7.2.1</b> Contingency Tables</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-stats.html"><a href="r-stats.html#r-stats-chisq"><i class="fa fa-check"></i><b>7.2.2</b> Chi-squared &amp; Fisher’s Exact Tests</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-stats.html"><a href="r-stats.html#r-stats-lm"><i class="fa fa-check"></i><b>7.3</b> Linear Models: Regression, ANOVA, and t-tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="r-stats.html"><a href="r-stats.html#regression"><i class="fa fa-check"></i><b>7.3.1</b> Regression</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-stats.html"><a href="r-stats.html#r-stats-anova"><i class="fa fa-check"></i><b>7.3.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-stats.html"><a href="r-stats.html#comparing-two-means-t-tests"><i class="fa fa-check"></i><b>7.3.3</b> Comparing two means (t-tests)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="r-vegan.html"><a href="r-vegan.html"><i class="fa fa-check"></i><b>8</b> Community ecology analyses with <code>vegan</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="r-vegan.html"><a href="r-vegan.html#setting-up-the-data"><i class="fa fa-check"></i><b>8.1</b> Setting up the data</a></li>
<li class="chapter" data-level="8.2" data-path="r-vegan.html"><a href="r-vegan.html#jaccard-similarity"><i class="fa fa-check"></i><b>8.2</b> Jaccard similarity</a></li>
<li class="chapter" data-level="8.3" data-path="r-vegan.html"><a href="r-vegan.html#species-accumulation-curves"><i class="fa fa-check"></i><b>8.3</b> Species Accumulation Curves</a></li>
<li class="chapter" data-level="8.4" data-path="r-vegan.html"><a href="r-vegan.html#rank-abundance-curves"><i class="fa fa-check"></i><b>8.4</b> Rank Abundance Curves</a></li>
<li class="chapter" data-level="8.5" data-path="r-vegan.html"><a href="r-vegan.html#shannon-index-diversity"><i class="fa fa-check"></i><b>8.5</b> Shannon Index &amp; Diversity</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-tidyr.html"><a href="r-tidyr.html"><i class="fa fa-check"></i><b>9</b> Wrangling, reshaping, and tidying data with <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="r-tidyr.html"><a href="r-tidyr.html#tidy-data"><i class="fa fa-check"></i><b>9.1</b> Tidy data</a></li>
<li class="chapter" data-level="9.2" data-path="r-tidyr.html"><a href="r-tidyr.html#pivot-longer-tutorial"><i class="fa fa-check"></i><b>9.2</b> Going from many columns to many rows: <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="9.3" data-path="r-tidyr.html"><a href="r-tidyr.html#separate-tutorial"><i class="fa fa-check"></i><b>9.3</b> Splitting and merging columns: <code>separate() and unite()</code></a></li>
<li class="chapter" data-level="9.4" data-path="r-tidyr.html"><a href="r-tidyr.html#pivot-longer-multi-tutorial"><i class="fa fa-check"></i><b>9.4</b> Pivoting multiple columns</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="r-tidyr.html"><a href="r-tidyr.html#combining-pivot_longer-with-summarise"><i class="fa fa-check"></i><b>9.4.1</b> Combining <code>pivot_longer()</code> with <code>summarise()</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Field Problems and Lab activities</b></span></li>
<li class="chapter" data-level="10" data-path="lab-succession.html"><a href="lab-succession.html"><i class="fa fa-check"></i><b>10</b> Succession Lab</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lab-succession.html"><a href="lab-succession.html#introduction-to-the-lab"><i class="fa fa-check"></i><b>10.1</b> Introduction to the lab</a></li>
<li class="chapter" data-level="10.2" data-path="lab-succession.html"><a href="lab-succession.html#materials-and-methods"><i class="fa fa-check"></i><b>10.2</b> Materials and Methods</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lab-succession.html"><a href="lab-succession.html#bfl-habitat-regions"><i class="fa fa-check"></i><b>10.2.1</b> BFL habitat regions</a></li>
<li class="chapter" data-level="10.2.2" data-path="lab-succession.html"><a href="lab-succession.html#data-collection"><i class="fa fa-check"></i><b>10.2.2</b> Data Collection</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="lab-succession.html"><a href="lab-succession.html#analysis-to-perform"><i class="fa fa-check"></i><b>10.3</b> Analysis to perform</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lab-succession.html"><a href="lab-succession.html#lab-succession-density"><i class="fa fa-check"></i><b>10.3.1</b> Canopy tree density</a></li>
<li class="chapter" data-level="10.3.2" data-path="lab-succession.html"><a href="lab-succession.html#species-by-habitat-and-life-stage"><i class="fa fa-check"></i><b>10.3.2</b> Species by habitat and life stage</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lab-succession.html"><a href="lab-succession.html#discussion-1"><i class="fa fa-check"></i><b>10.4</b> Discussion</a></li>
<li class="chapter" data-level="10.5" data-path="lab-succession.html"><a href="lab-succession.html#general-comments-post-review"><i class="fa fa-check"></i><b>10.5</b> General Comments (Post-Review)</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="lab-succession.html"><a href="lab-succession.html#figures-2"><i class="fa fa-check"></i><b>10.5.1</b> Figures</a></li>
<li class="chapter" data-level="10.5.2" data-path="lab-succession.html"><a href="lab-succession.html#write-this-like-youre-trying-to-publish-it"><i class="fa fa-check"></i><b>10.5.2</b> Write this like you’re trying to publish it</a></li>
<li class="chapter" data-level="10.5.3" data-path="lab-succession.html"><a href="lab-succession.html#describe-the-habitats"><i class="fa fa-check"></i><b>10.5.3</b> Describe the habitats</a></li>
<li class="chapter" data-level="10.5.4" data-path="lab-succession.html"><a href="lab-succession.html#the-analysis"><i class="fa fa-check"></i><b>10.5.4</b> The Analysis</a></li>
<li class="chapter" data-level="10.5.5" data-path="lab-succession.html"><a href="lab-succession.html#keeping-things-in-the-right-sections"><i class="fa fa-check"></i><b>10.5.5</b> Keeping things in the right sections</a></li>
<li class="chapter" data-level="10.5.6" data-path="lab-succession.html"><a href="lab-succession.html#basic-style-and-format-rules"><i class="fa fa-check"></i><b>10.5.6</b> Basic style and format rules</a></li>
<li class="chapter" data-level="10.5.7" data-path="lab-succession.html"><a href="lab-succession.html#other-comments"><i class="fa fa-check"></i><b>10.5.7</b> Other Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html"><i class="fa fa-check"></i><b>11</b> Mark-Release-Recapture (MRR) Lab</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#introduction-1"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#the-lincoln-petersen-model"><i class="fa fa-check"></i><b>11.1.1</b> The Lincoln-Petersen model</a></li>
<li class="chapter" data-level="11.1.2" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#heliconius-butterflies"><i class="fa fa-check"></i><b>11.1.2</b> <em>Heliconius</em> butterflies</a></li>
<li class="chapter" data-level="11.1.3" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#hardy-weinberg-equilbrium"><i class="fa fa-check"></i><b>11.1.3</b> Hardy-Weinberg Equilbrium</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#questions-and-hypotheses"><i class="fa fa-check"></i><b>11.2</b> Questions and hypotheses</a></li>
<li class="chapter" data-level="11.3" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#field-methods"><i class="fa fa-check"></i><b>11.3</b> Field Methods</a></li>
<li class="chapter" data-level="11.4" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#analysis"><i class="fa fa-check"></i><b>11.4</b> Analysis</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#effect-of-sampling-intensity-on-lincoln-petersen-hatn-estimates"><i class="fa fa-check"></i><b>11.4.1</b> Effect of sampling intensity on Lincoln-Petersen <span class="math inline">\(\hat{N}\)</span> estimates</a></li>
<li class="chapter" data-level="11.4.2" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#sex-ratios"><i class="fa fa-check"></i><b>11.4.2</b> Sex ratios</a></li>
<li class="chapter" data-level="11.4.3" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#comparison-of-lincoln-petersen-with-alternative-method"><i class="fa fa-check"></i><b>11.4.3</b> Comparison of Lincoln-Petersen with alternative method</a></li>
<li class="chapter" data-level="11.4.4" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#hardy-weinberg"><i class="fa fa-check"></i><b>11.4.4</b> Hardy-Weinberg</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="mark-release-recapture-mrr-lab.html"><a href="mark-release-recapture-mrr-lab.html#discussion-2"><i class="fa fa-check"></i><b>11.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html"><i class="fa fa-check"></i><b>12</b> Heterogeneity Lab:</a>
<ul>
<li class="chapter" data-level="12.1" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#introduction-background"><i class="fa fa-check"></i><b>12.1</b> Introduction &amp; background</a></li>
<li class="chapter" data-level="12.2" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#questions-and-hypotheses-1"><i class="fa fa-check"></i><b>12.2</b> Questions and Hypotheses</a></li>
<li class="chapter" data-level="12.3" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#field-methods-1"><i class="fa fa-check"></i><b>12.3</b> Field Methods</a></li>
<li class="chapter" data-level="12.4" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#analyses"><i class="fa fa-check"></i><b>12.4</b> Analyses</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#calibrating-canopy-estimates"><i class="fa fa-check"></i><b>12.4.1</b> Calibrating canopy estimates</a></li>
<li class="chapter" data-level="12.4.2" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#relationship-between-canopy-and-ground-cover"><i class="fa fa-check"></i><b>12.4.2</b> Relationship between canopy and ground cover</a></li>
<li class="chapter" data-level="12.4.3" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#quantifying-the-spatial-mosaic"><i class="fa fa-check"></i><b>12.4.3</b> Quantifying the spatial mosaic</a></li>
<li class="chapter" data-level="12.4.4" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#historical-comparison"><i class="fa fa-check"></i><b>12.4.4</b> Historical comparison</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="Lab-heterogeneity.html"><a href="Lab-heterogeneity.html#references"><i class="fa fa-check"></i><b>12.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Lab-ants.html"><a href="Lab-ants.html"><i class="fa fa-check"></i><b>13</b> Ant Lab: Ant Community Ecology and the Effects of Invasive Fire Ants</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Lab-ants.html"><a href="Lab-ants.html#background"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="Lab-ants.html"><a href="Lab-ants.html#questions-and-hypotheses-2"><i class="fa fa-check"></i><b>13.2</b> Questions and hypotheses</a></li>
<li class="chapter" data-level="13.3" data-path="Lab-ants.html"><a href="Lab-ants.html#methods-1"><i class="fa fa-check"></i><b>13.3</b> Methods</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="Lab-ants.html"><a href="Lab-ants.html#bait-survey"><i class="fa fa-check"></i><b>13.3.1</b> Bait Survey</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="Lab-ants.html"><a href="Lab-ants.html#analysis-1"><i class="fa fa-check"></i><b>13.4</b> Analysis</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="Lab-ants.html"><a href="Lab-ants.html#s.-invicta-habitat-preference"><i class="fa fa-check"></i><b>13.4.1</b> <em>S. invicta</em> habitat preference</a></li>
<li class="chapter" data-level="13.4.2" data-path="Lab-ants.html"><a href="Lab-ants.html#ant-community-differences"><i class="fa fa-check"></i><b>13.4.2</b> Ant community differences</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="Lab-ants.html"><a href="Lab-ants.html#references-1"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Lab-phorid.html"><a href="Lab-phorid.html"><i class="fa fa-check"></i><b>14</b> Phorid Lab: Parasitoid impacts on host foraging behavior with Phorid flies and fire ants</a>
<ul>
<li class="chapter" data-level="14.1" data-path="Lab-phorid.html"><a href="Lab-phorid.html#background-1"><i class="fa fa-check"></i><b>14.1</b> Background</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="Lab-phorid.html"><a href="Lab-phorid.html#fire-ants-and-phorid-flies"><i class="fa fa-check"></i><b>14.1.1</b> Fire ants and phorid flies</a></li>
<li class="chapter" data-level="14.1.2" data-path="Lab-phorid.html"><a href="Lab-phorid.html#fire-ants-natural-history"><i class="fa fa-check"></i><b>14.1.2</b> Fire ants natural history</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="Lab-phorid.html"><a href="Lab-phorid.html#objectives"><i class="fa fa-check"></i><b>14.2</b> Objectives</a></li>
<li class="chapter" data-level="14.3" data-path="Lab-phorid.html"><a href="Lab-phorid.html#methods-2"><i class="fa fa-check"></i><b>14.3</b> Methods</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="Lab-phorid.html"><a href="Lab-phorid.html#phorid-impact-on-fire-ant-foraging"><i class="fa fa-check"></i><b>14.3.1</b> Phorid impact on fire ant foraging</a></li>
<li class="chapter" data-level="14.3.2" data-path="Lab-phorid.html"><a href="Lab-phorid.html#using-the-hobo-mx2303-data-logger"><i class="fa fa-check"></i><b>14.3.2</b> Using the HOBO MX2303 data logger</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="Lab-phorid.html"><a href="Lab-phorid.html#analysis-2"><i class="fa fa-check"></i><b>14.4</b> Analysis</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="Lab-phorid.html"><a href="Lab-phorid.html#effect-of-phorids-on-ant-foraging"><i class="fa fa-check"></i><b>14.4.1</b> Effect of phorids on ant foraging</a></li>
<li class="chapter" data-level="14.4.2" data-path="Lab-phorid.html"><a href="Lab-phorid.html#effects-of-environmental-conditions"><i class="fa fa-check"></i><b>14.4.2</b> Effects of environmental conditions</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="Lab-phorid.html"><a href="Lab-phorid.html#discussion-3"><i class="fa fa-check"></i><b>14.5</b> Discussion</a></li>
<li class="chapter" data-level="14.6" data-path="Lab-phorid.html"><a href="Lab-phorid.html#some-questions-from-previous-semesters"><i class="fa fa-check"></i><b>14.6</b> Some questions from previous semesters:</a></li>
</ul></li>
<li class="part"><span><b>IV Analysis Homeworks</b></span></li>
<li class="chapter" data-level="15" data-path="hw-succession.html"><a href="hw-succession.html"><i class="fa fa-check"></i><b>15</b> Homework: Succession</a>
<ul>
<li class="chapter" data-level="15.1" data-path="hw-succession.html"><a href="hw-succession.html#required-reading"><i class="fa fa-check"></i><b>15.1</b> Required Reading</a></li>
<li class="chapter" data-level="15.2" data-path="hw-succession.html"><a href="hw-succession.html#objectives-1"><i class="fa fa-check"></i><b>15.2</b> Objectives</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="hw-succession.html"><a href="hw-succession.html#whats-due"><i class="fa fa-check"></i><b>15.2.1</b> What’s due?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="hw-succession.html"><a href="hw-succession.html#getting-started"><i class="fa fa-check"></i><b>15.3</b> Getting started</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="hw-succession.html"><a href="hw-succession.html#make-sure-your-software-is-up-to-date"><i class="fa fa-check"></i><b>15.3.1</b> Make sure your software is up-to-date</a></li>
<li class="chapter" data-level="15.3.2" data-path="hw-succession.html"><a href="hw-succession.html#create-the-rstudio-project"><i class="fa fa-check"></i><b>15.3.2</b> Create the RStudio Project</a></li>
<li class="chapter" data-level="15.3.3" data-path="hw-succession.html"><a href="hw-succession.html#create-an-r-script."><i class="fa fa-check"></i><b>15.3.3</b> Create an R script.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="hw-succession.html"><a href="hw-succession.html#the-data"><i class="fa fa-check"></i><b>15.4</b> The Data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="hw-succession.html"><a href="hw-succession.html#download-and-import-the-data"><i class="fa fa-check"></i><b>15.4.1</b> Download and import the data</a></li>
<li class="chapter" data-level="15.4.2" data-path="hw-succession.html"><a href="hw-succession.html#data"><i class="fa fa-check"></i><b>15.4.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="hw-succession.html"><a href="hw-succession.html#comparing-the-relative-abundance-of-canopy-and-sapling-trees-in-each-habitat"><i class="fa fa-check"></i><b>15.5</b> Comparing the relative abundance of canopy and sapling trees in each habitat</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="hw-succession.html"><a href="hw-succession.html#create-a-barplot-comparing-canopy-sapling-abundances"><i class="fa fa-check"></i><b>15.5.1</b> Create a barplot comparing canopy &amp; sapling abundances</a></li>
<li class="chapter" data-level="15.5.2" data-path="hw-succession.html"><a href="hw-succession.html#contingency-table-chi-squared-test-of-top-5-species"><i class="fa fa-check"></i><b>15.5.2</b> Contingency table &amp; chi-squared test of top 5 species</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="hw-succession.html"><a href="hw-succession.html#density"><i class="fa fa-check"></i><b>15.6</b> Density</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bio 373L Survival Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-ggplot" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Making graphs in R with <code>ggplot2</code></h1>
<div id="r-ggplot-components" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Components of a plot</h2>
<p>In this chapter, we discuss the basics of making figures with with the <code>ggplot2</code> package in R (part of the <code>tidyverse</code>.
The <code>ggplot2</code> package assembles a graph from several components. The important components are:</p>
<ul>
<li><strong>Data</strong>: You should have the data going into a plot organized into a data frame, where each row is an observation and each column is a different variable. This is called “tidy data;” we’ll talk more about it later.</li>
<li><strong>Aesthetics</strong>: Which variables (columns) in the data connect to visual components of the plot? E.g., what goes on the X &amp; Y axes, what does color mean, etc?</li>
<li><strong>Scales</strong>: How do your aesthetics visually appear? For example, if your aesthetics say that “Mass” is represented by color, a scale would say what colors those actually are.<br />
</li>
<li><strong>Geometry</strong>: What’s actually drawn on your graph (e.g., points, lines, bars, etc)</li>
<li><strong>Facets</strong>: If you’re splitting your figure into multiple panels, what data is informing that?</li>
</ul>
<p>Let’s look at an example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="r-ggplot.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages &amp; data</span></span>
<span id="cb14-2"><a href="r-ggplot.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb14-3"><a href="r-ggplot.html#cb14-3" aria-hidden="true" tabindex="-1"></a>lizards <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;example_data/anoles.csv&quot;</span>) </span>
<span id="cb14-4"><a href="r-ggplot.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If this throws an error, see Appendix A for how to download it.</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="r-ggplot.html#cb15-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="ot">&lt;-</span> </span>
<span id="cb15-2"><a href="r-ggplot.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> <span class="co"># Data: sets up a plot around lizards</span></span>
<span id="cb15-3"><a href="r-ggplot.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail) <span class="sc">+</span> <span class="co"># Aesthetics: Connects columns of lizards to x and y</span></span>
<span id="cb15-4"><a href="r-ggplot.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># Geometry: we&#39;re using points</span></span>
<span id="cb15-5"><a href="r-ggplot.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scales aren&#39;t listed, so they&#39;re using default values</span></span>
<span id="cb15-6"><a href="r-ggplot.html#cb15-6" aria-hidden="true" tabindex="-1"></a>base_plot <span class="co"># show results</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/basic_plt-1.png" width="672" /></p>
<p>This is a functional plot, but it doesn’t look much like a scientific figure. One quick option to change some of the default values is to use a theme. For this class, I’d like everyone to use the <code>cowplot</code> theme. Setting the theme will apply until you restart R.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="r-ggplot.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Include these two lines after loading tidyverse/ggplot2</span></span>
<span id="cb16-2"><a href="r-ggplot.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># at the top of each script</span></span>
<span id="cb16-3"><a href="r-ggplot.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb16-4"><a href="r-ggplot.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_cowplot</span>()) </span>
<span id="cb16-5"><a href="r-ggplot.html#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="r-ggplot.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now view the plot again, and see the results</span></span>
<span id="cb16-7"><a href="r-ggplot.html#cb16-7" aria-hidden="true" tabindex="-1"></a>base_plot</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/use_cowplot-1.png" width="672" /></p>
</div>
<div id="r-ggplot-aes" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Aesthetics and scales</h2>
<p>Aesthetics connect a column of data to a visual representation on the plot. For example, x and y are aesthetics that correspond to axis positions.</p>
<div id="r-ggplot-aes-color" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Color</h3>
<p>Color is a commonly use aesthetic; let’s add it to our <code>base_plot</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="r-ggplot.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect the color aesthetic with the Color_morph column in the data</span></span>
<span id="cb17-2"><a href="r-ggplot.html#cb17-2" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Color_morph)  <span class="co"># This is a discrete color</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_color_d-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="r-ggplot.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect the color aesthetic with the Limb column in the data</span></span>
<span id="cb18-2"><a href="r-ggplot.html#cb18-2" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Limb) <span class="co"># This is a continuous color</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_color_c-1.png" width="672" /></p>
<p>These aren’t particularly great color defaults; we can use scales to change them.
The <code>viridis</code> color scale is a good default option, since it’s generally colorblind friendly and isn’t terrible when printed in black &amp; white.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="r-ggplot.html#cb19-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="r-ggplot.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co"># uses the &quot;Viridis&quot; colors, discrete scale</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_color_vir_d-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="r-ggplot.html#cb20-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Limb) <span class="sc">+</span></span>
<span id="cb20-2"><a href="r-ggplot.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="co"># uses the &quot;Viridis&quot; colors, discrete scale</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_color_vir_c-1.png" width="672" /></p>
<p>You can also define your own colors for discrete variables:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="r-ggplot.html#cb21-1" aria-hidden="true" tabindex="-1"></a>my_morph_colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#a06f00&quot;</span>, <span class="st">&quot;#004368&quot;</span>, <span class="st">&quot;#e0a1c4&quot;</span>) <span class="co"># Color Hex codes; if you&#39;re unfamiliar, google it.</span></span>
<span id="cb21-2"><a href="r-ggplot.html#cb21-2" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="r-ggplot.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_morph_colors) </span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_color_manual-1.png" width="672" /></p>
<div id="r-ggplot-aes-fill" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Fill</h4>
<p>Related to color is the <code>fill</code> scale.
For geoms that have solid sections (e.g., box plots, bar graphs, densities), the outline of that shape corresponds to <code>color</code> while the area is controlled by <code>fill</code>.
Fill scales work almost exactly like color scales, except for the name (e.g., <code>scale_fill_manual()</code>, <code>scale_fill_viridis_d()</code>, etc).</p>
<p>For example, let’s make a version of the base plot that has both a color and fill aesthetic.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="r-ggplot.html#cb22-1" aria-hidden="true" tabindex="-1"></a>base_fill_plot <span class="ot">&lt;-</span> </span>
<span id="cb22-2"><a href="r-ggplot.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="r-ggplot.html#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="co"># Shape #21 is a filled circle, so it has both Fill and Color aesthetics</span></span>
<span id="cb22-4"><a href="r-ggplot.html#cb22-4" aria-hidden="true" tabindex="-1"></a>base_fill_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb22-5"><a href="r-ggplot.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_fill1-1.png" width="672" />
Note how the outlines of each point have the viridis colors, but the interior is empty.
Now, let’s try the same thing but with the fill aesthetic:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="r-ggplot.html#cb23-1" aria-hidden="true" tabindex="-1"></a>base_fill_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">fill =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="r-ggplot.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_fill2-1.png" width="672" />
These have black outlines (the default) and viridis centers.
It’s possible to use both together, of course:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="r-ggplot.html#cb24-1" aria-hidden="true" tabindex="-1"></a>base_fill_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">fill =</span> Color_morph, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="r-ggplot.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb24-3"><a href="r-ggplot.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;palevioletred&quot;</span>, <span class="st">&quot;darkseagreen2&quot;</span>, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_fill3-1.png" width="672" /></p>
</div>
</div>
<div id="r-ggplot-aes-shape" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Shape</h3>
<p>Shape only works for discrete variables</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="r-ggplot.html#cb25-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">shape =</span> Color_morph) </span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_shape1-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="r-ggplot.html#cb26-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">shape =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="r-ggplot.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">solid =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_shape2-1.png" width="672" /></p>
<p>If you want to set manual shapes, look at <code>?pch</code> to see what the options are.</p>
</div>
<div id="r-ggplot-aes-size" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Size</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="r-ggplot.html#cb27-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">size =</span> Limb)</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_size1-1.png" width="672" />
This is kind of a mess in its current state. Let’s fix that.</p>
</div>
<div id="r-ggplot-aes-fixed" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Fixed aesthetics</h3>
<p>You can define an aesthetic value as a constant within a <code>geom_*</code> call, and it will refer to that literal value instead of a data column.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="r-ggplot.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that I&#39;m including the aes() term with ggplot() instead</span></span>
<span id="cb28-2"><a href="r-ggplot.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of adding it; these are equivalent</span></span>
<span id="cb28-3"><a href="r-ggplot.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards, <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail, <span class="at">size =</span> Limb)) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="r-ggplot.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a default color &amp; shape for points</span></span>
<span id="cb28-5"><a href="r-ggplot.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/aes_fixed-1.png" width="672" /></p>
<p>This makes the previous cloud of points a bit easier to separate.</p>
</div>
<div id="r-ggplot-aes-combined" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Combining aesthetics</h3>
<p>Aesthetics are particularly powerful when combined. It can be helpful to double-up the aesthetics for a variable (to help improve clarity to the reader).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="r-ggplot.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="r-ggplot.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail, <span class="at">shape =</span> Color_morph, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="r-ggplot.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="r-ggplot.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">solid =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb29-5"><a href="r-ggplot.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/ase_comb_double-1.png" width="672" /></p>
<p>Or to use different aesthetics with different variables to explore different variable combinations</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="r-ggplot.html#cb30-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> Limb, <span class="at">shape =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="r-ggplot.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">solid =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="r-ggplot.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/ase_comb_multi-1.png" width="672" /></p>
</div>
</div>
<div id="geometry" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Geometry</h2>
<p>Geometry layers are different ways to visualize your data (primarly along the x and y aesthetics); different types of <code>geom_*</code> objects are suitable to different types of x and y data.</p>
<div id="r-ggplot-contx-noy" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Continuous X, no Y</h3>
<p>Histograms:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="r-ggplot.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="r-ggplot.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Diameter) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="r-ggplot.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Bio373L-Book_files/figure-html/geo_hist-1.png" width="672" /></p>
<p>Note that this generates a warning. R automatically assigns the data into bins. To remove the warning, povide the <code>binwidth</code> argument.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="r-ggplot.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="r-ggplot.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Diameter) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="r-ggplot.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">2.5</span>, </span>
<span id="cb33-4"><a href="r-ggplot.html#cb33-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) </span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_hist2-1.png" width="672" /></p>
<p>Note that we used the <code>color</code> and <code>fill</code> aesthetics; for solid objects (like bars), <code>color</code> refers to the outline and <code>fill</code> refers to the solid color.</p>
<p>Density Plots do something similar, but with a smooth estimate.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="r-ggplot.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="r-ggplot.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Diameter) <span class="sc">+</span> </span>
<span id="cb34-3"><a href="r-ggplot.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_dens-1.png" width="672" /></p>
<p>If you wanted to separate the density estimates by color morph, all you’d need to do is add that aesthetic.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="r-ggplot.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="r-ggplot.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Diameter, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb35-3"><a href="r-ggplot.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_dens_color-1.png" width="672" />
Challenge: How would you do the same with a histogram?</p>
</div>
<div id="r-ggplot-discx-conty" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Discrete X, continuous Y</h3>
<p>Boxplots: these show the quartile distributions of datasets. Let’s compare perch height distribution at each site:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="r-ggplot.html#cb36-1" aria-hidden="true" tabindex="-1"></a>box_plots <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="r-ggplot.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Height) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="r-ggplot.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb36-4"><a href="r-ggplot.html#cb36-4" aria-hidden="true" tabindex="-1"></a>box_plots</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_boxplot-1.png" width="672" /></p>
<p>Now let’s break that down by color morph</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="r-ggplot.html#cb37-1" aria-hidden="true" tabindex="-1"></a>box_plots <span class="sc">+</span> </span>
<span id="cb37-2"><a href="r-ggplot.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">fill =</span> Color_morph) <span class="sc">+</span> <span class="co"># We&#39;re using fill because boxplots are solid</span></span>
<span id="cb37-3"><a href="r-ggplot.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="co"># Move the legend to the bottom to give us more room</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_boxplot2-1.png" width="672" /></p>
<p>Violin plots are similar to density plots, but are more effective at comparing several groups.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="r-ggplot.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="r-ggplot.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Height) <span class="sc">+</span> </span>
<span id="cb38-3"><a href="r-ggplot.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()  </span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_viol-1.png" width="672" /></p>
<p>Jitter plots show individual data points for discrete groups; they add a bit of random noise to each x and y to prevent points from overlapping; the <strong>width</strong> and <strong>height</strong> arguments control how much in each direction. In this case, we only want jitter along the x.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="r-ggplot.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="r-ggplot.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Height) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="r-ggplot.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">25</span>, <span class="at">height =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_jitt-1.png" width="672" /></p>
<p>An alternate to the jitter plot is provided by <code>geom_sina</code> in the <code>ggforce</code> package (you’ll need to install it to make this work). This jitters the points on the x axis so they’ll fit within a violin plot.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="r-ggplot.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;ggforce&quot;) # Uncomment this to install</span></span>
<span id="cb40-2"><a href="r-ggplot.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce) </span>
<span id="cb40-3"><a href="r-ggplot.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="r-ggplot.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Height) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="r-ggplot.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb40-6"><a href="r-ggplot.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sina</span>(<span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="co"># Note that shape 21 uses both color a fill as aesthetics</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_sina-1.png" width="672" /></p>
<p>Note that we’ve included two <code>geom_*</code> layers here, and that the one that was called second (<code>geom_sina</code>) was plotted on top of the one called first.</p>
<p>Sometimes, you’ll want to show means &amp; confidence intervals of your different groups. If possible, it’s helpful to put those in the context of the raw data. The below plot looks at differences in perch diameter among colors, with the raw data in grey and the means in black. The error bars (<code>geom_errorbar</code>) take aesthetics <code>ymin</code> and <code>ymax</code>, which indicate their range. We used plus &amp; minus 1.96 standard errors because that’s the definition of a 95% confidence interval for normally distributed data. Be sure to tell your reader/audience what an error bar represents in your figure captions.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="r-ggplot.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to create a new data frame for mean &amp; standard error of perch diameter</span></span>
<span id="cb41-2"><a href="r-ggplot.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This uses dplyr commands, which are explained in the next appendix</span></span>
<span id="cb41-3"><a href="r-ggplot.html#cb41-3" aria-hidden="true" tabindex="-1"></a>diameter_mean_se <span class="ot">=</span> lizards <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="r-ggplot.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Color_morph) <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="r-ggplot.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb41-6"><a href="r-ggplot.html#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diameter_se =</span> <span class="fu">sd</span>(Diameter) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()), <span class="co"># Standard error</span></span>
<span id="cb41-7"><a href="r-ggplot.html#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diameter =</span> <span class="fu">mean</span>(Diameter)) <span class="co"># This mean diameter</span></span>
<span id="cb41-8"><a href="r-ggplot.html#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="r-ggplot.html#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizards) <span class="sc">+</span> </span>
<span id="cb41-10"><a href="r-ggplot.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Color_morph, <span class="at">y =</span> Diameter) <span class="sc">+</span> </span>
<span id="cb41-11"><a href="r-ggplot.html#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show the raw data (from the lizards data frame)</span></span>
<span id="cb41-12"><a href="r-ggplot.html#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sina</span>(, <span class="at">color =</span> <span class="st">&quot;grey60&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="r-ggplot.html#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show the Mean +/- 95% confidence interval</span></span>
<span id="cb41-14"><a href="r-ggplot.html#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb41-15"><a href="r-ggplot.html#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 95% CI is the mean diamter +/- 1.96 * se</span></span>
<span id="cb41-16"><a href="r-ggplot.html#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> Diameter <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> Diameter_se, </span>
<span id="cb41-17"><a href="r-ggplot.html#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> Diameter <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> Diameter_se),</span>
<span id="cb41-18"><a href="r-ggplot.html#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb41-19"><a href="r-ggplot.html#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">3</span>, <span class="co"># How wide the error bars are</span></span>
<span id="cb41-20"><a href="r-ggplot.html#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> diameter_mean_se <span class="co"># Use the summary data frame instead of lizards</span></span>
<span id="cb41-21"><a href="r-ggplot.html#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The column names should match with the global aesthetics (in this case, x and y)</span></span>
<span id="cb41-22"><a href="r-ggplot.html#cb41-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb41-23"><a href="r-ggplot.html#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb41-24"><a href="r-ggplot.html#cb41-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> diameter_mean_se</span>
<span id="cb41-25"><a href="r-ggplot.html#cb41-25" aria-hidden="true" tabindex="-1"></a>   <span class="co"># This one also uses the summary data frame</span></span>
<span id="cb41-26"><a href="r-ggplot.html#cb41-26" aria-hidden="true" tabindex="-1"></a>   <span class="co"># It keeps the global aesthetics, which match</span></span>
<span id="cb41-27"><a href="r-ggplot.html#cb41-27" aria-hidden="true" tabindex="-1"></a>   <span class="co"># the color morph &amp; mean value</span></span>
<span id="cb41-28"><a href="r-ggplot.html#cb41-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/mean_se_plot-1.png" width="672" /></p>
<p>In this example, we’ve also used two data frames in the plot. This can be useful if you’re combining two different types of data (such as raw &amp; summary, or individual &amp; site-level). The important thing to remember is that any columns named in the global aesthetics (defined by an <code>aes()</code> call that isn’t inside a <code>geom_*</code>) must be present in both data frames. In this case, those aesthetics are <code>Color_morph</code> and <code>Diameter.</code> <code>Diameter_se</code> is a local aesthetic (in <code>geom_errorbar</code>), so it doesn’t need to appear in all datasets.</p>
</div>
<div id="r-ggplot-contx-conty" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Continuous X and Y</h3>
<p>We’ve already seen <code>geom_point</code> used for continuous data. Here are a few other options:</p>
<p>Heatmap: this is sort of a 2-d histogram, where the data is divided into bins along both the x and y axis; the fill indicates how many data points fall into that region. This is helpful if you have a lot of points that are all overlapping in the same area.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="r-ggplot.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizards) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="r-ggplot.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="r-ggplot.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span> </span>
<span id="cb42-4"><a href="r-ggplot.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_heatmap-1.png" width="672" /></p>
<p>It’s often helpful to add regression lines to scatterpoint plots. This shows the the <code>Tail ~ SVL</code> regression, with the shaded region indicating the standard errors.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="r-ggplot.html#cb43-1" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="r-ggplot.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail) <span class="sc">+</span> </span>
<span id="cb43-3"><a href="r-ggplot.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># method = &quot;lm&quot; uses a linear regression</span></span>
<span id="cb43-4"><a href="r-ggplot.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use se = FALSE to disable error regions</span></span>
<span id="cb43-5"><a href="r-ggplot.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb43-6"><a href="r-ggplot.html#cb43-6" aria-hidden="true" tabindex="-1"></a>regression_plot </span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_lm1-1.png" width="672" /></p>
<p>You can also fit a regression to different groups of the data. This fits a separate one for each color:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="r-ggplot.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="r-ggplot.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="r-ggplot.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="r-ggplot.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb44-5"><a href="r-ggplot.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_lm2-1.png" width="672" /></p>
<p>Given that these regression lines all seem to be mostly the same, it may be better to fit them as one, but still indicate the different color morphs of the individual fits. You can specify certain aesthetics that only apply to a single geometric layer by including an <code>aes()</code> statement inside the <code>geom_*</code> call.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="r-ggplot.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="r-ggplot.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SVL, <span class="at">y =</span> Tail) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="r-ggplot.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="r-ggplot.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Color_morph)) <span class="sc">+</span> <span class="co"># call color here to only make it apply to points</span></span>
<span id="cb45-5"><a href="r-ggplot.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_lm3-1.png" width="672" /></p>
</div>
<div id="r-ggplot-ts" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Time series data</h3>
<p>If your x variable is related to time (or date), you’ll probably want to use a line plot to visualize it. Our anole dataset doesn’t work for this, so you’ll need to save <a href="https://raw.githubusercontent.com/Christopher-Peterson/Bio373L-Book/master/example_data/beavers.csv">this</a> as <code>"example_data/beavers.csv"</code>. This data has info on the body temperature of two beavers over time.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="r-ggplot.html#cb46-1" aria-hidden="true" tabindex="-1"></a>beavers <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;example_data/beavers.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Time = col_datetime(format = &quot;&quot;),
##   Temperature = col_double(),
##   activ = col_double(),
##   beaver = col_character()
## )</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="r-ggplot.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beavers) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="r-ggplot.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Temperature, <span class="at">color =</span> beaver) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="r-ggplot.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb48-4"><a href="r-ggplot.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_datetime</span>(<span class="at">date_labels =</span> <span class="st">&quot;%H:%M&quot;</span>) <span class="co"># This tells R that you&#39;ve got a time on the x axis</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/beaver_ts-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="r-ggplot.html#cb49-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># date_labels says to use hours:minutes as the axis format</span></span></code></pre></div>
</div>
<div id="r-ggplot-discx-discy" class="section level3" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Discrete X and Y</h3>
<p>Bar graphs are good for showing counts, frequencies, and proportions. This shows how many individual lizards were in each site; It works by counting the number of rows in which the Site column has each value.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="r-ggplot.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="r-ggplot.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site) <span class="sc">+</span></span>
<span id="cb50-3"><a href="r-ggplot.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_bar1-1.png" width="672" /></p>
<p>If you use a grouping aesthetic, you’ll get a stacked bar plot by default:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="r-ggplot.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="r-ggplot.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">fill =</span> Perch_type) <span class="sc">+</span></span>
<span id="cb51-3"><a href="r-ggplot.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb51-4"><a href="r-ggplot.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_bar_stacked-1.png" width="672" /></p>
<p>Sometimes, stacking can be hard to interpret; you can have your categories lined next to each other by specifying the bar position as <strong>dodge</strong>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="r-ggplot.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb52-2"><a href="r-ggplot.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">fill =</span> Perch_type) <span class="sc">+</span></span>
<span id="cb52-3"><a href="r-ggplot.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="r-ggplot.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_bar_dodge-1.png" width="672" /></p>
<p>It’s usually a good idea to have your bars ordered in a descending frequency; you can do this by using <code>fct_infreq()</code> in your <code>aes()</code> statement.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="r-ggplot.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lizards) <span class="sc">+</span> </span>
<span id="cb53-2"><a href="r-ggplot.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(Site), <span class="co"># Note how this changes the axis label</span></span>
<span id="cb53-3"><a href="r-ggplot.html#cb53-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> Perch_type) <span class="sc">+</span> <span class="co"># We&#39;ll talk about how to fix that in a bit</span></span>
<span id="cb53-4"><a href="r-ggplot.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geo_bars_infreq-1.png" width="672" /></p>
<p>If you wish to use frequencies instead of counts along the y axis, it’s usually a better idea to calculate them yourself and display those numbers. You can use <code>geom_col()</code> for these displays; it’s like <code>geom_bar()</code>, but it takes a user-suplied <code>y</code> aesthetic.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="r-ggplot.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code uses dplyr, which is discussed in the next appendix. Don&#39;t worry if it doesn&#39;t make sense now.</span></span>
<span id="cb54-2"><a href="r-ggplot.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Overal perch_height frequency</span></span>
<span id="cb54-3"><a href="r-ggplot.html#cb54-3" aria-hidden="true" tabindex="-1"></a>lizard_perch_freq <span class="ot">=</span> lizards <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="r-ggplot.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Perch_type) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="r-ggplot.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="r-ggplot.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate frequencies per-group</span></span>
<span id="cb54-7"><a href="r-ggplot.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frequency =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-8"><a href="r-ggplot.html#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sort by frequency</span></span>
<span id="cb54-9"><a href="r-ggplot.html#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(frequency)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="r-ggplot.html#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tell ggplot to plot Perch_type in its current order</span></span>
<span id="cb54-11"><a href="r-ggplot.html#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Perch_type =</span> <span class="fu">fct_inorder</span>(Perch_type))</span>
<span id="cb54-12"><a href="r-ggplot.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># feel free to use View() to look at this</span></span>
<span id="cb54-13"><a href="r-ggplot.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizard_perch_freq) <span class="sc">+</span> </span>
<span id="cb54-14"><a href="r-ggplot.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Perch_type, <span class="at">y =</span> frequency) <span class="sc">+</span> </span>
<span id="cb54-15"><a href="r-ggplot.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/geom_col_data-1.png" width="672" /></p>
</div>
</div>
<div id="facets" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Facets</h2>
<p>You can use facets to make multi-panel figures. This can highlight differences between groups if including them in the same panel is too busy or messy. Let’s start by taking our previous regression plot and separating it by color morph.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="r-ggplot.html#cb55-1" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="sc">+</span></span>
<span id="cb55-2"><a href="r-ggplot.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Color_morph) <span class="co"># note the ~</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/facet_reg_color-1.png" width="672" /></p>
<p>It doesn’t look like there’s much there. What about faceting by site?</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="r-ggplot.html#cb56-1" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="sc">+</span></span>
<span id="cb56-2"><a href="r-ggplot.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Site) <span class="co"># note the ~</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/facet_reg_site1-1.png" width="672" /></p>
<p>In this case, it looks like the data ranges are quite a bit different among the sites. This leads to a large amount of unused space. You may wish to remove this whitespace.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r-ggplot.html#cb57-1" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="sc">+</span></span>
<span id="cb57-2"><a href="r-ggplot.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Site, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="co"># scales can also be &#39;free_y&#39; or &#39;free&#39; (which does both x and y)</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/facet_reg_site2-1.png" width="672" /></p>
<p>You can also facet by two variables into rows &amp; columns with <code>facet_grid()</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="r-ggplot.html#cb58-1" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="sc">+</span></span>
<span id="cb58-2"><a href="r-ggplot.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Perch_type<span class="sc">~</span>Color_morph) <span class="co"># rows ~ columns</span></span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/facet_grd-1.png" width="672" /></p>
</div>
<div id="r-ggplot-tweaks" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Changing the theme, axis titles, &amp; other visual elements</h2>
<p>By default, ggplot will name your axis labels &amp; legends by whatever you put in the <code>aes</code> string. You may wish to change that. For example, the labels on this plot could be improved:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="r-ggplot.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizards) <span class="sc">+</span> </span>
<span id="cb59-2"><a href="r-ggplot.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Limb, <span class="at">y =</span> Diameter, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb59-3"><a href="r-ggplot.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb59-4"><a href="r-ggplot.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/no_theme_plot-1.png" width="672" /></p>
<p>The <code>xlab()</code> and <code>ylab()</code> commands can provide labels for their respective axes, while the <code>name</code> argument can re-label scales.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="r-ggplot.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizards) <span class="sc">+</span> </span>
<span id="cb60-2"><a href="r-ggplot.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Limb, <span class="at">y =</span> Diameter, <span class="at">color =</span> Color_morph) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="r-ggplot.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb60-4"><a href="r-ggplot.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">name =</span> <span class="st">&quot;Color Morph&quot;</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="r-ggplot.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Hind Limb Length (mm)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="r-ggplot.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Perch Diameter (mm)&quot;</span>)</span></code></pre></div>
<p><img src="Bio373L-Book_files/figure-html/with_labs-1.png" width="672" /></p>
<p>More complicated options involve tweaking the theme. I’m not going to get into this right now, but I may update this later if conditions call for it. There is an example of using it to move the legend position several sections ago.</p>
</div>
<div id="more-references" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> More references</h2>
<p>You can find a cheatsheet for ggplot2 in RStudio under <strong>Help -&gt; Cheatsheets</strong>; this covers most of the basic functions. The <a href="https://ggplot2.tidyverse.org/reference/">official website</a> has a full list of geoms, scales, aesthetics, theme options, and everything else; it’s a more developed version of R’s built-in help mechanism. <em>R for Data Science</em> has a <a href="https://r4ds.had.co.nz/data-visualisation.html">chapter</a> on <code>ggplot2</code> that is also quite helpful. Finally, it’s worth looking at the <a href="figures.html#figures">Figures</a> chapter of this book for more examples; the code used to make those figures is linked at the bottom of the chapter.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-dplyr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Christopher-Peterson/Bio373L-Book/edit/master/chapters/analysis/r_ggplot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Christopher-Peterson/Bio373L-Book/blob/master/chapters/analysis/r_ggplot.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
